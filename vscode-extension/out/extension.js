"use strict";var Mo=Object.create;var ze=Object.defineProperty;var Do=Object.getOwnPropertyDescriptor;var $o=Object.getOwnPropertyNames;var Fo=Object.getPrototypeOf,Lo=Object.prototype.hasOwnProperty;var L=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Ho=(s,e)=>{for(var t in e)ze(s,t,{get:e[t],enumerable:!0})},As=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of $o(e))!Lo.call(s,o)&&o!==t&&ze(s,o,{get:()=>e[o],enumerable:!(r=Do(e,o))||r.enumerable});return s};var z=(s,e,t)=>(t=s!=null?Mo(Fo(s)):{},As(e||!s||!s.__esModule?ze(t,"default",{value:s,enumerable:!0}):t,s)),Oo=s=>As(ze({},"__esModule",{value:!0}),s);var Pe=L((rc,Ms)=>{"use strict";var jo=require("path"),ue="\\\\/",Ps=`[^${ue}]`,he="\\.",Bo="\\+",Wo="\\?",Qe="\\/",Uo="(?=.)",ks="[^/]",At=`(?:${Qe}|$)`,Ts=`(?:^|${Qe})`,Ct=`${he}{1,2}${At}`,Go=`(?!${he})`,qo=`(?!${Ts}${Ct})`,Ko=`(?!${he}{0,1}${At})`,zo=`(?!${Ct})`,Vo=`[^.${Qe}]`,Yo=`${ks}*?`,Is={DOT_LITERAL:he,PLUS_LITERAL:Bo,QMARK_LITERAL:Wo,SLASH_LITERAL:Qe,ONE_CHAR:Uo,QMARK:ks,END_ANCHOR:At,DOTS_SLASH:Ct,NO_DOT:Go,NO_DOTS:qo,NO_DOT_SLASH:Ko,NO_DOTS_SLASH:zo,QMARK_NO_DOT:Vo,STAR:Yo,START_ANCHOR:Ts},Qo={...Is,SLASH_LITERAL:`[${ue}]`,QMARK:Ps,STAR:`${Ps}*?`,DOTS_SLASH:`${he}{1,2}(?:[${ue}]|$)`,NO_DOT:`(?!${he})`,NO_DOTS:`(?!(?:^|[${ue}])${he}{1,2}(?:[${ue}]|$))`,NO_DOT_SLASH:`(?!${he}{0,1}(?:[${ue}]|$))`,NO_DOTS_SLASH:`(?!${he}{1,2}(?:[${ue}]|$))`,QMARK_NO_DOT:`[^.${ue}]`,START_ANCHOR:`(?:^|[${ue}])`,END_ANCHOR:`(?:[${ue}]|$)`},Xo={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Ms.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Xo,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:jo.sep,extglobChars(s){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${s.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(s){return s===!0?Qo:Is}}});var Xe=L(te=>{"use strict";var Zo=require("path"),Jo=process.platform==="win32",{REGEX_BACKSLASH:en,REGEX_REMOVE_BACKSLASH:tn,REGEX_SPECIAL_CHARS:sn,REGEX_SPECIAL_CHARS_GLOBAL:rn}=Pe();te.isObject=s=>s!==null&&typeof s=="object"&&!Array.isArray(s);te.hasRegexChars=s=>sn.test(s);te.isRegexChar=s=>s.length===1&&te.hasRegexChars(s);te.escapeRegex=s=>s.replace(rn,"\\$1");te.toPosixSlashes=s=>s.replace(en,"/");te.removeBackslashes=s=>s.replace(tn,e=>e==="\\"?"":e);te.supportsLookbehinds=()=>{let s=process.version.slice(1).split(".").map(Number);return s.length===3&&s[0]>=9||s[0]===8&&s[1]>=10};te.isWindows=s=>s&&typeof s.windows=="boolean"?s.windows:Jo===!0||Zo.sep==="\\";te.escapeLast=(s,e,t)=>{let r=s.lastIndexOf(e,t);return r===-1?s:s[r-1]==="\\"?te.escapeLast(s,e,r-1):`${s.slice(0,r)}\\${s.slice(r)}`};te.removePrefix=(s,e={})=>{let t=s;return t.startsWith("./")&&(t=t.slice(2),e.prefix="./"),t};te.wrapOutput=(s,e={},t={})=>{let r=t.contains?"":"^",o=t.contains?"":"$",i=`${r}(?:${s})${o}`;return e.negated===!0&&(i=`(?:^(?!${i}).*$)`),i}});var js=L((nc,Ns)=>{"use strict";var Ds=Xe(),{CHAR_ASTERISK:Pt,CHAR_AT:on,CHAR_BACKWARD_SLASH:ke,CHAR_COMMA:nn,CHAR_DOT:kt,CHAR_EXCLAMATION_MARK:Tt,CHAR_FORWARD_SLASH:Os,CHAR_LEFT_CURLY_BRACE:It,CHAR_LEFT_PARENTHESES:Mt,CHAR_LEFT_SQUARE_BRACKET:an,CHAR_PLUS:cn,CHAR_QUESTION_MARK:$s,CHAR_RIGHT_CURLY_BRACE:ln,CHAR_RIGHT_PARENTHESES:Fs,CHAR_RIGHT_SQUARE_BRACKET:dn}=Pe(),Ls=s=>s===Os||s===ke,Hs=s=>{s.isPrefix!==!0&&(s.depth=s.isGlobstar?1/0:1)},un=(s,e)=>{let t=e||{},r=s.length-1,o=t.parts===!0||t.scanToEnd===!0,i=[],n=[],a=[],c=s,h=-1,u=0,p=0,l=!1,f=!1,w=!1,y=!1,E=!1,A=!1,C=!1,x=!1,M=!1,I=!1,P=0,D,S,F={value:"",depth:0,isGlob:!1},Q=()=>h>=r,v=()=>c.charCodeAt(h+1),B=()=>(D=S,c.charCodeAt(++h));for(;h<r;){S=B();let J;if(S===ke){C=F.backslashes=!0,S=B(),S===It&&(A=!0);continue}if(A===!0||S===It){for(P++;Q()!==!0&&(S=B());){if(S===ke){C=F.backslashes=!0,B();continue}if(S===It){P++;continue}if(A!==!0&&S===kt&&(S=B())===kt){if(l=F.isBrace=!0,w=F.isGlob=!0,I=!0,o===!0)continue;break}if(A!==!0&&S===nn){if(l=F.isBrace=!0,w=F.isGlob=!0,I=!0,o===!0)continue;break}if(S===ln&&(P--,P===0)){A=!1,l=F.isBrace=!0,I=!0;break}}if(o===!0)continue;break}if(S===Os){if(i.push(h),n.push(F),F={value:"",depth:0,isGlob:!1},I===!0)continue;if(D===kt&&h===u+1){u+=2;continue}p=h+1;continue}if(t.noext!==!0&&(S===cn||S===on||S===Pt||S===$s||S===Tt)===!0&&v()===Mt){if(w=F.isGlob=!0,y=F.isExtglob=!0,I=!0,S===Tt&&h===u&&(M=!0),o===!0){for(;Q()!==!0&&(S=B());){if(S===ke){C=F.backslashes=!0,S=B();continue}if(S===Fs){w=F.isGlob=!0,I=!0;break}}continue}break}if(S===Pt){if(D===Pt&&(E=F.isGlobstar=!0),w=F.isGlob=!0,I=!0,o===!0)continue;break}if(S===$s){if(w=F.isGlob=!0,I=!0,o===!0)continue;break}if(S===an){for(;Q()!==!0&&(J=B());){if(J===ke){C=F.backslashes=!0,B();continue}if(J===dn){f=F.isBracket=!0,w=F.isGlob=!0,I=!0;break}}if(o===!0)continue;break}if(t.nonegate!==!0&&S===Tt&&h===u){x=F.negated=!0,u++;continue}if(t.noparen!==!0&&S===Mt){if(w=F.isGlob=!0,o===!0){for(;Q()!==!0&&(S=B());){if(S===Mt){C=F.backslashes=!0,S=B();continue}if(S===Fs){I=!0;break}}continue}break}if(w===!0){if(I=!0,o===!0)continue;break}}t.noext===!0&&(y=!1,w=!1);let N=c,ge="",g="";u>0&&(ge=c.slice(0,u),c=c.slice(u),p-=u),N&&w===!0&&p>0?(N=c.slice(0,p),g=c.slice(p)):w===!0?(N="",g=c):N=c,N&&N!==""&&N!=="/"&&N!==c&&Ls(N.charCodeAt(N.length-1))&&(N=N.slice(0,-1)),t.unescape===!0&&(g&&(g=Ds.removeBackslashes(g)),N&&C===!0&&(N=Ds.removeBackslashes(N)));let m={prefix:ge,input:s,start:u,base:N,glob:g,isBrace:l,isBracket:f,isGlob:w,isExtglob:y,isGlobstar:E,negated:x,negatedExtglob:M};if(t.tokens===!0&&(m.maxDepth=0,Ls(S)||n.push(F),m.tokens=n),t.parts===!0||t.tokens===!0){let J;for(let $=0;$<i.length;$++){let le=J?J+1:u,de=i[$],se=s.slice(le,de);t.tokens&&($===0&&u!==0?(n[$].isPrefix=!0,n[$].value=ge):n[$].value=se,Hs(n[$]),m.maxDepth+=n[$].depth),($!==0||se!=="")&&a.push(se),J=de}if(J&&J+1<s.length){let $=s.slice(J+1);a.push($),t.tokens&&(n[n.length-1].value=$,Hs(n[n.length-1]),m.maxDepth+=n[n.length-1].depth)}m.slashes=i,m.parts=a}return m};Ns.exports=un});var Us=L((ic,Ws)=>{"use strict";var Ze=Pe(),re=Xe(),{MAX_LENGTH:Je,POSIX_REGEX_SOURCE:pn,REGEX_NON_SPECIAL_CHARS:hn,REGEX_SPECIAL_CHARS_BACKREF:fn,REPLACEMENTS:Bs}=Ze,gn=(s,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...s,e);s.sort();let t=`[${s.join("-")}]`;try{new RegExp(t)}catch{return s.map(o=>re.escapeRegex(o)).join("..")}return t},be=(s,e)=>`Missing ${s}: "${e}" - use "\\\\${e}" to match literal characters`,Dt=(s,e)=>{if(typeof s!="string")throw new TypeError("Expected a string");s=Bs[s]||s;let t={...e},r=typeof t.maxLength=="number"?Math.min(Je,t.maxLength):Je,o=s.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);let i={type:"bos",value:"",output:t.prepend||""},n=[i],a=t.capture?"":"?:",c=re.isWindows(e),h=Ze.globChars(c),u=Ze.extglobChars(h),{DOT_LITERAL:p,PLUS_LITERAL:l,SLASH_LITERAL:f,ONE_CHAR:w,DOTS_SLASH:y,NO_DOT:E,NO_DOT_SLASH:A,NO_DOTS_SLASH:C,QMARK:x,QMARK_NO_DOT:M,STAR:I,START_ANCHOR:P}=h,D=b=>`(${a}(?:(?!${P}${b.dot?y:p}).)*?)`,S=t.dot?"":E,F=t.dot?x:M,Q=t.bash===!0?D(t):I;t.capture&&(Q=`(${Q})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);let v={input:s,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:n};s=re.removePrefix(s,v),o=s.length;let B=[],N=[],ge=[],g=i,m,J=()=>v.index===o-1,$=v.peek=(b=1)=>s[v.index+b],le=v.advance=()=>s[++v.index]||"",de=()=>s.slice(v.index+1),se=(b="",j=0)=>{v.consumed+=b,v.index+=j},Ue=b=>{v.output+=b.output!=null?b.output:b.value,se(b.value)},To=()=>{let b=1;for(;$()==="!"&&($(2)!=="("||$(3)==="?");)le(),v.start++,b++;return b%2===0?!1:(v.negated=!0,v.start++,!0)},Ge=b=>{v[b]++,ge.push(b)},me=b=>{v[b]--,ge.pop()},T=b=>{if(g.type==="globstar"){let j=v.braces>0&&(b.type==="comma"||b.type==="brace"),_=b.extglob===!0||B.length&&(b.type==="pipe"||b.type==="paren");b.type!=="slash"&&b.type!=="paren"&&!j&&!_&&(v.output=v.output.slice(0,-g.output.length),g.type="star",g.value="*",g.output=Q,v.output+=g.output)}if(B.length&&b.type!=="paren"&&(B[B.length-1].inner+=b.value),(b.value||b.output)&&Ue(b),g&&g.type==="text"&&b.type==="text"){g.value+=b.value,g.output=(g.output||"")+b.value;return}b.prev=g,n.push(b),g=b},qe=(b,j)=>{let _={...u[j],conditions:1,inner:""};_.prev=g,_.parens=v.parens,_.output=v.output;let k=(t.capture?"(":"")+_.open;Ge("parens"),T({type:b,value:j,output:v.output?"":w}),T({type:"paren",extglob:!0,value:le(),output:k}),B.push(_)},Io=b=>{let j=b.close+(t.capture?")":""),_;if(b.type==="negate"){let k=Q;if(b.inner&&b.inner.length>1&&b.inner.includes("/")&&(k=D(t)),(k!==Q||J()||/^\)+$/.test(de()))&&(j=b.close=`)$))${k}`),b.inner.includes("*")&&(_=de())&&/^\.[^\\/.]+$/.test(_)){let W=Dt(_,{...e,fastpaths:!1}).output;j=b.close=`)${W})${k})`}b.prev.type==="bos"&&(v.negatedExtglob=!0)}T({type:"paren",extglob:!0,value:m,output:j}),me("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(s)){let b=!1,j=s.replace(fn,(_,k,W,ee,q,St)=>ee==="\\"?(b=!0,_):ee==="?"?k?k+ee+(q?x.repeat(q.length):""):St===0?F+(q?x.repeat(q.length):""):x.repeat(W.length):ee==="."?p.repeat(W.length):ee==="*"?k?k+ee+(q?Q:""):Q:k?_:`\\${_}`);return b===!0&&(t.unescape===!0?j=j.replace(/\\/g,""):j=j.replace(/\\+/g,_=>_.length%2===0?"\\\\":_?"\\":"")),j===s&&t.contains===!0?(v.output=s,v):(v.output=re.wrapOutput(j,v,e),v)}for(;!J();){if(m=le(),m==="\0")continue;if(m==="\\"){let _=$();if(_==="/"&&t.bash!==!0||_==="."||_===";")continue;if(!_){m+="\\",T({type:"text",value:m});continue}let k=/^\\+/.exec(de()),W=0;if(k&&k[0].length>2&&(W=k[0].length,v.index+=W,W%2!==0&&(m+="\\")),t.unescape===!0?m=le():m+=le(),v.brackets===0){T({type:"text",value:m});continue}}if(v.brackets>0&&(m!=="]"||g.value==="["||g.value==="[^")){if(t.posix!==!1&&m===":"){let _=g.value.slice(1);if(_.includes("[")&&(g.posix=!0,_.includes(":"))){let k=g.value.lastIndexOf("["),W=g.value.slice(0,k),ee=g.value.slice(k+2),q=pn[ee];if(q){g.value=W+q,v.backtrack=!0,le(),!i.output&&n.indexOf(g)===1&&(i.output=w);continue}}}(m==="["&&$()!==":"||m==="-"&&$()==="]")&&(m=`\\${m}`),m==="]"&&(g.value==="["||g.value==="[^")&&(m=`\\${m}`),t.posix===!0&&m==="!"&&g.value==="["&&(m="^"),g.value+=m,Ue({value:m});continue}if(v.quotes===1&&m!=='"'){m=re.escapeRegex(m),g.value+=m,Ue({value:m});continue}if(m==='"'){v.quotes=v.quotes===1?0:1,t.keepQuotes===!0&&T({type:"text",value:m});continue}if(m==="("){Ge("parens"),T({type:"paren",value:m});continue}if(m===")"){if(v.parens===0&&t.strictBrackets===!0)throw new SyntaxError(be("opening","("));let _=B[B.length-1];if(_&&v.parens===_.parens+1){Io(B.pop());continue}T({type:"paren",value:m,output:v.parens?")":"\\)"}),me("parens");continue}if(m==="["){if(t.nobracket===!0||!de().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(be("closing","]"));m=`\\${m}`}else Ge("brackets");T({type:"bracket",value:m});continue}if(m==="]"){if(t.nobracket===!0||g&&g.type==="bracket"&&g.value.length===1){T({type:"text",value:m,output:`\\${m}`});continue}if(v.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(be("opening","["));T({type:"text",value:m,output:`\\${m}`});continue}me("brackets");let _=g.value.slice(1);if(g.posix!==!0&&_[0]==="^"&&!_.includes("/")&&(m=`/${m}`),g.value+=m,Ue({value:m}),t.literalBrackets===!1||re.hasRegexChars(_))continue;let k=re.escapeRegex(g.value);if(v.output=v.output.slice(0,-g.value.length),t.literalBrackets===!0){v.output+=k,g.value=k;continue}g.value=`(${a}${k}|${g.value})`,v.output+=g.value;continue}if(m==="{"&&t.nobrace!==!0){Ge("braces");let _={type:"brace",value:m,output:"(",outputIndex:v.output.length,tokensIndex:v.tokens.length};N.push(_),T(_);continue}if(m==="}"){let _=N[N.length-1];if(t.nobrace===!0||!_){T({type:"text",value:m,output:m});continue}let k=")";if(_.dots===!0){let W=n.slice(),ee=[];for(let q=W.length-1;q>=0&&(n.pop(),W[q].type!=="brace");q--)W[q].type!=="dots"&&ee.unshift(W[q].value);k=gn(ee,t),v.backtrack=!0}if(_.comma!==!0&&_.dots!==!0){let W=v.output.slice(0,_.outputIndex),ee=v.tokens.slice(_.tokensIndex);_.value=_.output="\\{",m=k="\\}",v.output=W;for(let q of ee)v.output+=q.output||q.value}T({type:"brace",value:m,output:k}),me("braces"),N.pop();continue}if(m==="|"){B.length>0&&B[B.length-1].conditions++,T({type:"text",value:m});continue}if(m===","){let _=m,k=N[N.length-1];k&&ge[ge.length-1]==="braces"&&(k.comma=!0,_="|"),T({type:"comma",value:m,output:_});continue}if(m==="/"){if(g.type==="dot"&&v.index===v.start+1){v.start=v.index+1,v.consumed="",v.output="",n.pop(),g=i;continue}T({type:"slash",value:m,output:f});continue}if(m==="."){if(v.braces>0&&g.type==="dot"){g.value==="."&&(g.output=p);let _=N[N.length-1];g.type="dots",g.output+=m,g.value+=m,_.dots=!0;continue}if(v.braces+v.parens===0&&g.type!=="bos"&&g.type!=="slash"){T({type:"text",value:m,output:p});continue}T({type:"dot",value:m,output:p});continue}if(m==="?"){if(!(g&&g.value==="(")&&t.noextglob!==!0&&$()==="("&&$(2)!=="?"){qe("qmark",m);continue}if(g&&g.type==="paren"){let k=$(),W=m;if(k==="<"&&!re.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(g.value==="("&&!/[!=<:]/.test(k)||k==="<"&&!/<([!=]|\w+>)/.test(de()))&&(W=`\\${m}`),T({type:"text",value:m,output:W});continue}if(t.dot!==!0&&(g.type==="slash"||g.type==="bos")){T({type:"qmark",value:m,output:M});continue}T({type:"qmark",value:m,output:x});continue}if(m==="!"){if(t.noextglob!==!0&&$()==="("&&($(2)!=="?"||!/[!=<:]/.test($(3)))){qe("negate",m);continue}if(t.nonegate!==!0&&v.index===0){To();continue}}if(m==="+"){if(t.noextglob!==!0&&$()==="("&&$(2)!=="?"){qe("plus",m);continue}if(g&&g.value==="("||t.regex===!1){T({type:"plus",value:m,output:l});continue}if(g&&(g.type==="bracket"||g.type==="paren"||g.type==="brace")||v.parens>0){T({type:"plus",value:m});continue}T({type:"plus",value:l});continue}if(m==="@"){if(t.noextglob!==!0&&$()==="("&&$(2)!=="?"){T({type:"at",extglob:!0,value:m,output:""});continue}T({type:"text",value:m});continue}if(m!=="*"){(m==="$"||m==="^")&&(m=`\\${m}`);let _=hn.exec(de());_&&(m+=_[0],v.index+=_[0].length),T({type:"text",value:m});continue}if(g&&(g.type==="globstar"||g.star===!0)){g.type="star",g.star=!0,g.value+=m,g.output=Q,v.backtrack=!0,v.globstar=!0,se(m);continue}let b=de();if(t.noextglob!==!0&&/^\([^?]/.test(b)){qe("star",m);continue}if(g.type==="star"){if(t.noglobstar===!0){se(m);continue}let _=g.prev,k=_.prev,W=_.type==="slash"||_.type==="bos",ee=k&&(k.type==="star"||k.type==="globstar");if(t.bash===!0&&(!W||b[0]&&b[0]!=="/")){T({type:"star",value:m,output:""});continue}let q=v.braces>0&&(_.type==="comma"||_.type==="brace"),St=B.length&&(_.type==="pipe"||_.type==="paren");if(!W&&_.type!=="paren"&&!q&&!St){T({type:"star",value:m,output:""});continue}for(;b.slice(0,3)==="/**";){let Ke=s[v.index+4];if(Ke&&Ke!=="/")break;b=b.slice(3),se("/**",3)}if(_.type==="bos"&&J()){g.type="globstar",g.value+=m,g.output=D(t),v.output=g.output,v.globstar=!0,se(m);continue}if(_.type==="slash"&&_.prev.type!=="bos"&&!ee&&J()){v.output=v.output.slice(0,-(_.output+g.output).length),_.output=`(?:${_.output}`,g.type="globstar",g.output=D(t)+(t.strictSlashes?")":"|$)"),g.value+=m,v.globstar=!0,v.output+=_.output+g.output,se(m);continue}if(_.type==="slash"&&_.prev.type!=="bos"&&b[0]==="/"){let Ke=b[1]!==void 0?"|$":"";v.output=v.output.slice(0,-(_.output+g.output).length),_.output=`(?:${_.output}`,g.type="globstar",g.output=`${D(t)}${f}|${f}${Ke})`,g.value+=m,v.output+=_.output+g.output,v.globstar=!0,se(m+le()),T({type:"slash",value:"/",output:""});continue}if(_.type==="bos"&&b[0]==="/"){g.type="globstar",g.value+=m,g.output=`(?:^|${f}|${D(t)}${f})`,v.output=g.output,v.globstar=!0,se(m+le()),T({type:"slash",value:"/",output:""});continue}v.output=v.output.slice(0,-g.output.length),g.type="globstar",g.output=D(t),g.value+=m,v.output+=g.output,v.globstar=!0,se(m);continue}let j={type:"star",value:m,output:Q};if(t.bash===!0){j.output=".*?",(g.type==="bos"||g.type==="slash")&&(j.output=S+j.output),T(j);continue}if(g&&(g.type==="bracket"||g.type==="paren")&&t.regex===!0){j.output=m,T(j);continue}(v.index===v.start||g.type==="slash"||g.type==="dot")&&(g.type==="dot"?(v.output+=A,g.output+=A):t.dot===!0?(v.output+=C,g.output+=C):(v.output+=S,g.output+=S),$()!=="*"&&(v.output+=w,g.output+=w)),T(j)}for(;v.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(be("closing","]"));v.output=re.escapeLast(v.output,"["),me("brackets")}for(;v.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(be("closing",")"));v.output=re.escapeLast(v.output,"("),me("parens")}for(;v.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(be("closing","}"));v.output=re.escapeLast(v.output,"{"),me("braces")}if(t.strictSlashes!==!0&&(g.type==="star"||g.type==="bracket")&&T({type:"maybe_slash",value:"",output:`${f}?`}),v.backtrack===!0){v.output="";for(let b of v.tokens)v.output+=b.output!=null?b.output:b.value,b.suffix&&(v.output+=b.suffix)}return v};Dt.fastpaths=(s,e)=>{let t={...e},r=typeof t.maxLength=="number"?Math.min(Je,t.maxLength):Je,o=s.length;if(o>r)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${r}`);s=Bs[s]||s;let i=re.isWindows(e),{DOT_LITERAL:n,SLASH_LITERAL:a,ONE_CHAR:c,DOTS_SLASH:h,NO_DOT:u,NO_DOTS:p,NO_DOTS_SLASH:l,STAR:f,START_ANCHOR:w}=Ze.globChars(i),y=t.dot?p:u,E=t.dot?l:u,A=t.capture?"":"?:",C={negated:!1,prefix:""},x=t.bash===!0?".*?":f;t.capture&&(x=`(${x})`);let M=S=>S.noglobstar===!0?x:`(${A}(?:(?!${w}${S.dot?h:n}).)*?)`,I=S=>{switch(S){case"*":return`${y}${c}${x}`;case".*":return`${n}${c}${x}`;case"*.*":return`${y}${x}${n}${c}${x}`;case"*/*":return`${y}${x}${a}${c}${E}${x}`;case"**":return y+M(t);case"**/*":return`(?:${y}${M(t)}${a})?${E}${c}${x}`;case"**/*.*":return`(?:${y}${M(t)}${a})?${E}${x}${n}${c}${x}`;case"**/.*":return`(?:${y}${M(t)}${a})?${n}${c}${x}`;default:{let F=/^(.*?)\.(\w+)$/.exec(S);if(!F)return;let Q=I(F[1]);return Q?Q+n+F[2]:void 0}}},P=re.removePrefix(s,C),D=I(P);return D&&t.strictSlashes!==!0&&(D+=`${a}?`),D};Ws.exports=Dt});var qs=L((ac,Gs)=>{"use strict";var mn=require("path"),wn=js(),$t=Us(),Ft=Xe(),vn=Pe(),yn=s=>s&&typeof s=="object"&&!Array.isArray(s),G=(s,e,t=!1)=>{if(Array.isArray(s)){let u=s.map(l=>G(l,e,t));return l=>{for(let f of u){let w=f(l);if(w)return w}return!1}}let r=yn(s)&&s.tokens&&s.input;if(s===""||typeof s!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let o=e||{},i=Ft.isWindows(e),n=r?G.compileRe(s,e):G.makeRe(s,e,!1,!0),a=n.state;delete n.state;let c=()=>!1;if(o.ignore){let u={...e,ignore:null,onMatch:null,onResult:null};c=G(o.ignore,u,t)}let h=(u,p=!1)=>{let{isMatch:l,match:f,output:w}=G.test(u,n,e,{glob:s,posix:i}),y={glob:s,state:a,regex:n,posix:i,input:u,output:w,match:f,isMatch:l};return typeof o.onResult=="function"&&o.onResult(y),l===!1?(y.isMatch=!1,p?y:!1):c(u)?(typeof o.onIgnore=="function"&&o.onIgnore(y),y.isMatch=!1,p?y:!1):(typeof o.onMatch=="function"&&o.onMatch(y),p?y:!0)};return t&&(h.state=a),h};G.test=(s,e,t,{glob:r,posix:o}={})=>{if(typeof s!="string")throw new TypeError("Expected input to be a string");if(s==="")return{isMatch:!1,output:""};let i=t||{},n=i.format||(o?Ft.toPosixSlashes:null),a=s===r,c=a&&n?n(s):s;return a===!1&&(c=n?n(s):s,a=c===r),(a===!1||i.capture===!0)&&(i.matchBase===!0||i.basename===!0?a=G.matchBase(s,e,t,o):a=e.exec(c)),{isMatch:!!a,match:a,output:c}};G.matchBase=(s,e,t,r=Ft.isWindows(t))=>(e instanceof RegExp?e:G.makeRe(e,t)).test(mn.basename(s));G.isMatch=(s,e,t)=>G(e,t)(s);G.parse=(s,e)=>Array.isArray(s)?s.map(t=>G.parse(t,e)):$t(s,{...e,fastpaths:!1});G.scan=(s,e)=>wn(s,e);G.compileRe=(s,e,t=!1,r=!1)=>{if(t===!0)return s.output;let o=e||{},i=o.contains?"":"^",n=o.contains?"":"$",a=`${i}(?:${s.output})${n}`;s&&s.negated===!0&&(a=`^(?!${a}).*$`);let c=G.toRegex(a,e);return r===!0&&(c.state=s),c};G.makeRe=(s,e={},t=!1,r=!1)=>{if(!s||typeof s!="string")throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(s[0]==="."||s[0]==="*")&&(o.output=$t.fastpaths(s,e)),o.output||(o=$t(s,e)),G.compileRe(o,e,t,r)};G.toRegex=(s,e)=>{try{let t=e||{};return new RegExp(s,t.flags||(t.nocase?"i":""))}catch(t){if(e&&e.debug===!0)throw t;return/$^/}};G.constants=vn;Gs.exports=G});var Lt=L((cc,Ks)=>{"use strict";Ks.exports=qs()});var er=L((lc,Js)=>{"use strict";var Ie=require("fs"),{Readable:_n}=require("stream"),Te=require("path"),{promisify:rt}=require("util"),Ht=Lt(),bn=rt(Ie.readdir),En=rt(Ie.stat),zs=rt(Ie.lstat),Rn=rt(Ie.realpath),xn="!",Xs="READDIRP_RECURSIVE_ERROR",Sn=new Set(["ENOENT","EPERM","EACCES","ELOOP",Xs]),Ot="files",Zs="directories",tt="files_directories",et="all",Vs=[Ot,Zs,tt,et],An=s=>Sn.has(s.code),[Ys,Cn]=process.versions.node.split(".").slice(0,2).map(s=>Number.parseInt(s,10)),Pn=process.platform==="win32"&&(Ys>10||Ys===10&&Cn>=5),Qs=s=>{if(s!==void 0){if(typeof s=="function")return s;if(typeof s=="string"){let e=Ht(s.trim());return t=>e(t.basename)}if(Array.isArray(s)){let e=[],t=[];for(let r of s){let o=r.trim();o.charAt(0)===xn?t.push(Ht(o.slice(1))):e.push(Ht(o))}return t.length>0?e.length>0?r=>e.some(o=>o(r.basename))&&!t.some(o=>o(r.basename)):r=>!t.some(o=>o(r.basename)):r=>e.some(o=>o(r.basename))}}},st=class s extends _n{static get defaultOptions(){return{root:".",fileFilter:e=>!0,directoryFilter:e=>!0,type:Ot,lstat:!1,depth:2147483648,alwaysStat:!1}}constructor(e={}){super({objectMode:!0,autoDestroy:!0,highWaterMark:e.highWaterMark||4096});let t={...s.defaultOptions,...e},{root:r,type:o}=t;this._fileFilter=Qs(t.fileFilter),this._directoryFilter=Qs(t.directoryFilter);let i=t.lstat?zs:En;Pn?this._stat=n=>i(n,{bigint:!0}):this._stat=i,this._maxDepth=t.depth,this._wantsDir=[Zs,tt,et].includes(o),this._wantsFile=[Ot,tt,et].includes(o),this._wantsEverything=o===et,this._root=Te.resolve(r),this._isDirent="Dirent"in Ie&&!t.alwaysStat,this._statsProp=this._isDirent?"dirent":"stats",this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent},this.parents=[this._exploreDir(r,1)],this.reading=!1,this.parent=void 0}async _read(e){if(!this.reading){this.reading=!0;try{for(;!this.destroyed&&e>0;){let{path:t,depth:r,files:o=[]}=this.parent||{};if(o.length>0){let i=o.splice(0,e).map(n=>this._formatEntry(n,t));for(let n of await Promise.all(i)){if(this.destroyed)return;let a=await this._getEntryType(n);a==="directory"&&this._directoryFilter(n)?(r<=this._maxDepth&&this.parents.push(this._exploreDir(n.fullPath,r+1)),this._wantsDir&&(this.push(n),e--)):(a==="file"||this._includeAsFile(n))&&this._fileFilter(n)&&this._wantsFile&&(this.push(n),e--)}}else{let i=this.parents.pop();if(!i){this.push(null);break}if(this.parent=await i,this.destroyed)return}}}catch(t){this.destroy(t)}finally{this.reading=!1}}}async _exploreDir(e,t){let r;try{r=await bn(e,this._rdOptions)}catch(o){this._onError(o)}return{files:r,depth:t,path:e}}async _formatEntry(e,t){let r;try{let o=this._isDirent?e.name:e,i=Te.resolve(Te.join(t,o));r={path:Te.relative(this._root,i),fullPath:i,basename:o},r[this._statsProp]=this._isDirent?e:await this._stat(i)}catch(o){this._onError(o)}return r}_onError(e){An(e)&&!this.destroyed?this.emit("warn",e):this.destroy(e)}async _getEntryType(e){let t=e&&e[this._statsProp];if(t){if(t.isFile())return"file";if(t.isDirectory())return"directory";if(t&&t.isSymbolicLink()){let r=e.fullPath;try{let o=await Rn(r),i=await zs(o);if(i.isFile())return"file";if(i.isDirectory()){let n=o.length;if(r.startsWith(o)&&r.substr(n,1)===Te.sep){let a=new Error(`Circular symlink detected: "${r}" points to "${o}"`);return a.code=Xs,this._onError(a)}return"directory"}}catch(o){this._onError(o)}}}}_includeAsFile(e){let t=e&&e[this._statsProp];return t&&this._wantsEverything&&!t.isDirectory()}},Ee=(s,e={})=>{let t=e.entryType||e.type;if(t==="both"&&(t=tt),t&&(e.type=t),s){if(typeof s!="string")throw new TypeError("readdirp: root argument must be a string. Usage: readdirp(root, options)");if(t&&!Vs.includes(t))throw new Error(`readdirp: Invalid type passed. Use one of ${Vs.join(", ")}`)}else throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)");return e.root=s,new st(e)},kn=(s,e={})=>new Promise((t,r)=>{let o=[];Ee(s,e).on("data",i=>o.push(i)).on("end",()=>t(o)).on("error",i=>r(i))});Ee.promise=kn;Ee.ReaddirpStream=st;Ee.default=Ee;Js.exports=Ee});var Nt=L((dc,tr)=>{tr.exports=function(s,e){if(typeof s!="string")throw new TypeError("expected path to be a string");if(s==="\\"||s==="/")return"/";var t=s.length;if(t<=1)return s;var r="";if(t>4&&s[3]==="\\"){var o=s[2];(o==="?"||o===".")&&s.slice(0,2)==="\\\\"&&(s=s.slice(2),r="//")}var i=s.split(/[/\\]+/);return e!==!1&&i[i.length-1]===""&&i.pop(),r+i.join("/")}});var ar=L((nr,ir)=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});var or=Lt(),Tn=Nt(),sr="!",In={returnIndex:!1},Mn=s=>Array.isArray(s)?s:[s],Dn=(s,e)=>{if(typeof s=="function")return s;if(typeof s=="string"){let t=or(s,e);return r=>s===r||t(r)}return s instanceof RegExp?t=>s.test(t):t=>!1},rr=(s,e,t,r)=>{let o=Array.isArray(t),i=o?t[0]:t;if(!o&&typeof i!="string")throw new TypeError("anymatch: second argument must be a string: got "+Object.prototype.toString.call(i));let n=Tn(i,!1);for(let c=0;c<e.length;c++){let h=e[c];if(h(n))return r?-1:!1}let a=o&&[n].concat(t.slice(1));for(let c=0;c<s.length;c++){let h=s[c];if(o?h(...a):h(n))return r?c:!0}return r?-1:!1},jt=(s,e,t=In)=>{if(s==null)throw new TypeError("anymatch: specify first argument");let r=typeof t=="boolean"?{returnIndex:t}:t,o=r.returnIndex||!1,i=Mn(s),n=i.filter(c=>typeof c=="string"&&c.charAt(0)===sr).map(c=>c.slice(1)).map(c=>or(c,r)),a=i.filter(c=>typeof c!="string"||typeof c=="string"&&c.charAt(0)!==sr).map(c=>Dn(c,r));return e==null?(c,h=!1)=>rr(a,n,c,typeof h=="boolean"?h:!1):rr(a,n,e,o)};jt.default=jt;ir.exports=jt});var lr=L((uc,cr)=>{cr.exports=function(e){if(typeof e!="string"||e==="")return!1;for(var t;t=/(\\).|([@?!+*]\(.*\))/g.exec(e);){if(t[2])return!0;e=e.slice(t.index+t[0].length)}return!1}});var Bt=L((pc,ur)=>{var $n=lr(),dr={"{":"}","(":")","[":"]"},Fn=function(s){if(s[0]==="!")return!0;for(var e=0,t=-2,r=-2,o=-2,i=-2,n=-2;e<s.length;){if(s[e]==="*"||s[e+1]==="?"&&/[\].+)]/.test(s[e])||r!==-1&&s[e]==="["&&s[e+1]!=="]"&&(r<e&&(r=s.indexOf("]",e)),r>e&&(n===-1||n>r||(n=s.indexOf("\\",e),n===-1||n>r)))||o!==-1&&s[e]==="{"&&s[e+1]!=="}"&&(o=s.indexOf("}",e),o>e&&(n=s.indexOf("\\",e),n===-1||n>o))||i!==-1&&s[e]==="("&&s[e+1]==="?"&&/[:!=]/.test(s[e+2])&&s[e+3]!==")"&&(i=s.indexOf(")",e),i>e&&(n=s.indexOf("\\",e),n===-1||n>i))||t!==-1&&s[e]==="("&&s[e+1]!=="|"&&(t<e&&(t=s.indexOf("|",e)),t!==-1&&s[t+1]!==")"&&(i=s.indexOf(")",t),i>t&&(n=s.indexOf("\\",t),n===-1||n>i))))return!0;if(s[e]==="\\"){var a=s[e+1];e+=2;var c=dr[a];if(c){var h=s.indexOf(c,e);h!==-1&&(e=h+1)}if(s[e]==="!")return!0}else e++}return!1},Ln=function(s){if(s[0]==="!")return!0;for(var e=0;e<s.length;){if(/[*?{}()[\]]/.test(s[e]))return!0;if(s[e]==="\\"){var t=s[e+1];e+=2;var r=dr[t];if(r){var o=s.indexOf(r,e);o!==-1&&(e=o+1)}if(s[e]==="!")return!0}else e++}return!1};ur.exports=function(e,t){if(typeof e!="string"||e==="")return!1;if($n(e))return!0;var r=Fn;return t&&t.strict===!1&&(r=Ln),r(e)}});var hr=L((hc,pr)=>{"use strict";var Hn=Bt(),On=require("path").posix.dirname,Nn=require("os").platform()==="win32",Wt="/",jn=/\\/g,Bn=/[\{\[].*[\}\]]$/,Wn=/(^|[^\\])([\{\[]|\([^\)]+$)/,Un=/\\([\!\*\?\|\[\]\(\)\{\}])/g;pr.exports=function(e,t){var r=Object.assign({flipBackslashes:!0},t);r.flipBackslashes&&Nn&&e.indexOf(Wt)<0&&(e=e.replace(jn,Wt)),Bn.test(e)&&(e+=Wt),e+="a";do e=On(e);while(Hn(e)||Wn.test(e));return e.replace(Un,"$1")}});var ot=L(ne=>{"use strict";ne.isInteger=s=>typeof s=="number"?Number.isInteger(s):typeof s=="string"&&s.trim()!==""?Number.isInteger(Number(s)):!1;ne.find=(s,e)=>s.nodes.find(t=>t.type===e);ne.exceedsLimit=(s,e,t=1,r)=>r===!1||!ne.isInteger(s)||!ne.isInteger(e)?!1:(Number(e)-Number(s))/Number(t)>=r;ne.escapeNode=(s,e=0,t)=>{let r=s.nodes[e];r&&(t&&r.type===t||r.type==="open"||r.type==="close")&&r.escaped!==!0&&(r.value="\\"+r.value,r.escaped=!0)};ne.encloseBrace=s=>s.type!=="brace"?!1:s.commas>>0+s.ranges>>0===0?(s.invalid=!0,!0):!1;ne.isInvalidBrace=s=>s.type!=="brace"?!1:s.invalid===!0||s.dollar?!0:s.commas>>0+s.ranges>>0===0||s.open!==!0||s.close!==!0?(s.invalid=!0,!0):!1;ne.isOpenOrClose=s=>s.type==="open"||s.type==="close"?!0:s.open===!0||s.close===!0;ne.reduce=s=>s.reduce((e,t)=>(t.type==="text"&&e.push(t.value),t.type==="range"&&(t.type="text"),e),[]);ne.flatten=(...s)=>{let e=[],t=r=>{for(let o=0;o<r.length;o++){let i=r[o];if(Array.isArray(i)){t(i);continue}i!==void 0&&e.push(i)}return e};return t(s),e}});var nt=L((gc,gr)=>{"use strict";var fr=ot();gr.exports=(s,e={})=>{let t=(r,o={})=>{let i=e.escapeInvalid&&fr.isInvalidBrace(o),n=r.invalid===!0&&e.escapeInvalid===!0,a="";if(r.value)return(i||n)&&fr.isOpenOrClose(r)?"\\"+r.value:r.value;if(r.value)return r.value;if(r.nodes)for(let c of r.nodes)a+=t(c);return a};return t(s)}});var wr=L((mc,mr)=>{"use strict";mr.exports=function(s){return typeof s=="number"?s-s===0:typeof s=="string"&&s.trim()!==""?Number.isFinite?Number.isFinite(+s):isFinite(+s):!1}});var Ar=L((wc,Sr)=>{"use strict";var vr=wr(),we=(s,e,t)=>{if(vr(s)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(e===void 0||s===e)return String(s);if(vr(e)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let r={relaxZeros:!0,...t};typeof r.strictZeros=="boolean"&&(r.relaxZeros=r.strictZeros===!1);let o=String(r.relaxZeros),i=String(r.shorthand),n=String(r.capture),a=String(r.wrap),c=s+":"+e+"="+o+i+n+a;if(we.cache.hasOwnProperty(c))return we.cache[c].result;let h=Math.min(s,e),u=Math.max(s,e);if(Math.abs(h-u)===1){let y=s+"|"+e;return r.capture?`(${y})`:r.wrap===!1?y:`(?:${y})`}let p=xr(s)||xr(e),l={min:s,max:e,a:h,b:u},f=[],w=[];if(p&&(l.isPadded=p,l.maxLen=String(l.max).length),h<0){let y=u<0?Math.abs(u):1;w=yr(y,Math.abs(h),l,r),h=l.a=0}return u>=0&&(f=yr(h,u,l,r)),l.negatives=w,l.positives=f,l.result=Gn(w,f,r),r.capture===!0?l.result=`(${l.result})`:r.wrap!==!1&&f.length+w.length>1&&(l.result=`(?:${l.result})`),we.cache[c]=l,l.result};function Gn(s,e,t){let r=Ut(s,e,"-",!1,t)||[],o=Ut(e,s,"",!1,t)||[],i=Ut(s,e,"-?",!0,t)||[];return r.concat(i).concat(o).join("|")}function qn(s,e){let t=1,r=1,o=br(s,t),i=new Set([e]);for(;s<=o&&o<=e;)i.add(o),t+=1,o=br(s,t);for(o=Er(e+1,r)-1;s<o&&o<=e;)i.add(o),r+=1,o=Er(e+1,r)-1;return i=[...i],i.sort(Vn),i}function Kn(s,e,t){if(s===e)return{pattern:s,count:[],digits:0};let r=zn(s,e),o=r.length,i="",n=0;for(let a=0;a<o;a++){let[c,h]=r[a];c===h?i+=c:c!=="0"||h!=="9"?i+=Yn(c,h,t):n++}return n&&(i+=t.shorthand===!0?"\\d":"[0-9]"),{pattern:i,count:[n],digits:o}}function yr(s,e,t,r){let o=qn(s,e),i=[],n=s,a;for(let c=0;c<o.length;c++){let h=o[c],u=Kn(String(n),String(h),r),p="";if(!t.isPadded&&a&&a.pattern===u.pattern){a.count.length>1&&a.count.pop(),a.count.push(u.count[0]),a.string=a.pattern+Rr(a.count),n=h+1;continue}t.isPadded&&(p=Qn(h,t,r)),u.string=p+u.pattern+Rr(u.count),i.push(u),n=h+1,a=u}return i}function Ut(s,e,t,r,o){let i=[];for(let n of s){let{string:a}=n;!r&&!_r(e,"string",a)&&i.push(t+a),r&&_r(e,"string",a)&&i.push(t+a)}return i}function zn(s,e){let t=[];for(let r=0;r<s.length;r++)t.push([s[r],e[r]]);return t}function Vn(s,e){return s>e?1:e>s?-1:0}function _r(s,e,t){return s.some(r=>r[e]===t)}function br(s,e){return Number(String(s).slice(0,-e)+"9".repeat(e))}function Er(s,e){return s-s%Math.pow(10,e)}function Rr(s){let[e=0,t=""]=s;return t||e>1?`{${e+(t?","+t:"")}}`:""}function Yn(s,e,t){return`[${s}${e-s===1?"":"-"}${e}]`}function xr(s){return/^-?(0+)\d/.test(s)}function Qn(s,e,t){if(!e.isPadded)return s;let r=Math.abs(e.maxLen-String(s).length),o=t.relaxZeros!==!1;switch(r){case 0:return"";case 1:return o?"0?":"0";case 2:return o?"0{0,2}":"00";default:return o?`0{0,${r}}`:`0{${r}}`}}we.cache={};we.clearCache=()=>we.cache={};Sr.exports=we});var Kt=L((vc,Dr)=>{"use strict";var Xn=require("util"),Pr=Ar(),Cr=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),Zn=s=>e=>s===!0?Number(e):String(e),Gt=s=>typeof s=="number"||typeof s=="string"&&s!=="",Me=s=>Number.isInteger(+s),qt=s=>{let e=`${s}`,t=-1;if(e[0]==="-"&&(e=e.slice(1)),e==="0")return!1;for(;e[++t]==="0";);return t>0},Jn=(s,e,t)=>typeof s=="string"||typeof e=="string"?!0:t.stringify===!0,ei=(s,e,t)=>{if(e>0){let r=s[0]==="-"?"-":"";r&&(s=s.slice(1)),s=r+s.padStart(r?e-1:e,"0")}return t===!1?String(s):s},at=(s,e)=>{let t=s[0]==="-"?"-":"";for(t&&(s=s.slice(1),e--);s.length<e;)s="0"+s;return t?"-"+s:s},ti=(s,e,t)=>{s.negatives.sort((a,c)=>a<c?-1:a>c?1:0),s.positives.sort((a,c)=>a<c?-1:a>c?1:0);let r=e.capture?"":"?:",o="",i="",n;return s.positives.length&&(o=s.positives.map(a=>at(String(a),t)).join("|")),s.negatives.length&&(i=`-(${r}${s.negatives.map(a=>at(String(a),t)).join("|")})`),o&&i?n=`${o}|${i}`:n=o||i,e.wrap?`(${r}${n})`:n},kr=(s,e,t,r)=>{if(t)return Pr(s,e,{wrap:!1,...r});let o=String.fromCharCode(s);if(s===e)return o;let i=String.fromCharCode(e);return`[${o}-${i}]`},Tr=(s,e,t)=>{if(Array.isArray(s)){let r=t.wrap===!0,o=t.capture?"":"?:";return r?`(${o}${s.join("|")})`:s.join("|")}return Pr(s,e,t)},Ir=(...s)=>new RangeError("Invalid range arguments: "+Xn.inspect(...s)),Mr=(s,e,t)=>{if(t.strictRanges===!0)throw Ir([s,e]);return[]},si=(s,e)=>{if(e.strictRanges===!0)throw new TypeError(`Expected step "${s}" to be a number`);return[]},ri=(s,e,t=1,r={})=>{let o=Number(s),i=Number(e);if(!Number.isInteger(o)||!Number.isInteger(i)){if(r.strictRanges===!0)throw Ir([s,e]);return[]}o===0&&(o=0),i===0&&(i=0);let n=o>i,a=String(s),c=String(e),h=String(t);t=Math.max(Math.abs(t),1);let u=qt(a)||qt(c)||qt(h),p=u?Math.max(a.length,c.length,h.length):0,l=u===!1&&Jn(s,e,r)===!1,f=r.transform||Zn(l);if(r.toRegex&&t===1)return kr(at(s,p),at(e,p),!0,r);let w={negatives:[],positives:[]},y=C=>w[C<0?"negatives":"positives"].push(Math.abs(C)),E=[],A=0;for(;n?o>=i:o<=i;)r.toRegex===!0&&t>1?y(o):E.push(ei(f(o,A),p,l)),o=n?o-t:o+t,A++;return r.toRegex===!0?t>1?ti(w,r,p):Tr(E,null,{wrap:!1,...r}):E},oi=(s,e,t=1,r={})=>{if(!Me(s)&&s.length>1||!Me(e)&&e.length>1)return Mr(s,e,r);let o=r.transform||(l=>String.fromCharCode(l)),i=`${s}`.charCodeAt(0),n=`${e}`.charCodeAt(0),a=i>n,c=Math.min(i,n),h=Math.max(i,n);if(r.toRegex&&t===1)return kr(c,h,!1,r);let u=[],p=0;for(;a?i>=n:i<=n;)u.push(o(i,p)),i=a?i-t:i+t,p++;return r.toRegex===!0?Tr(u,null,{wrap:!1,options:r}):u},it=(s,e,t,r={})=>{if(e==null&&Gt(s))return[s];if(!Gt(s)||!Gt(e))return Mr(s,e,r);if(typeof t=="function")return it(s,e,1,{transform:t});if(Cr(t))return it(s,e,0,t);let o={...r};return o.capture===!0&&(o.wrap=!0),t=t||o.step||1,Me(t)?Me(s)&&Me(e)?ri(s,e,t,o):oi(s,e,Math.max(Math.abs(t),1),o):t!=null&&!Cr(t)?si(t,o):it(s,e,1,t)};Dr.exports=it});var Lr=L((yc,Fr)=>{"use strict";var ni=Kt(),$r=ot(),ii=(s,e={})=>{let t=(r,o={})=>{let i=$r.isInvalidBrace(o),n=r.invalid===!0&&e.escapeInvalid===!0,a=i===!0||n===!0,c=e.escapeInvalid===!0?"\\":"",h="";if(r.isOpen===!0)return c+r.value;if(r.isClose===!0)return console.log("node.isClose",c,r.value),c+r.value;if(r.type==="open")return a?c+r.value:"(";if(r.type==="close")return a?c+r.value:")";if(r.type==="comma")return r.prev.type==="comma"?"":a?r.value:"|";if(r.value)return r.value;if(r.nodes&&r.ranges>0){let u=$r.reduce(r.nodes),p=ni(...u,{...e,wrap:!1,toRegex:!0,strictZeros:!0});if(p.length!==0)return u.length>1&&p.length>1?`(${p})`:p}if(r.nodes)for(let u of r.nodes)h+=t(u,r);return h};return t(s)};Fr.exports=ii});var Nr=L((_c,Or)=>{"use strict";var ai=Kt(),Hr=nt(),Re=ot(),ve=(s="",e="",t=!1)=>{let r=[];if(s=[].concat(s),e=[].concat(e),!e.length)return s;if(!s.length)return t?Re.flatten(e).map(o=>`{${o}}`):e;for(let o of s)if(Array.isArray(o))for(let i of o)r.push(ve(i,e,t));else for(let i of e)t===!0&&typeof i=="string"&&(i=`{${i}}`),r.push(Array.isArray(i)?ve(o,i,t):o+i);return Re.flatten(r)},ci=(s,e={})=>{let t=e.rangeLimit===void 0?1e3:e.rangeLimit,r=(o,i={})=>{o.queue=[];let n=i,a=i.queue;for(;n.type!=="brace"&&n.type!=="root"&&n.parent;)n=n.parent,a=n.queue;if(o.invalid||o.dollar){a.push(ve(a.pop(),Hr(o,e)));return}if(o.type==="brace"&&o.invalid!==!0&&o.nodes.length===2){a.push(ve(a.pop(),["{}"]));return}if(o.nodes&&o.ranges>0){let p=Re.reduce(o.nodes);if(Re.exceedsLimit(...p,e.step,t))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let l=ai(...p,e);l.length===0&&(l=Hr(o,e)),a.push(ve(a.pop(),l)),o.nodes=[];return}let c=Re.encloseBrace(o),h=o.queue,u=o;for(;u.type!=="brace"&&u.type!=="root"&&u.parent;)u=u.parent,h=u.queue;for(let p=0;p<o.nodes.length;p++){let l=o.nodes[p];if(l.type==="comma"&&o.type==="brace"){p===1&&h.push(""),h.push("");continue}if(l.type==="close"){a.push(ve(a.pop(),h,c));continue}if(l.value&&l.type!=="open"){h.push(ve(h.pop(),l.value));continue}l.nodes&&r(l,o)}return h};return Re.flatten(r(s))};Or.exports=ci});var Br=L((bc,jr)=>{"use strict";jr.exports={MAX_LENGTH:1e4,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}});var Kr=L((Ec,qr)=>{"use strict";var li=nt(),{MAX_LENGTH:Wr,CHAR_BACKSLASH:zt,CHAR_BACKTICK:di,CHAR_COMMA:ui,CHAR_DOT:pi,CHAR_LEFT_PARENTHESES:hi,CHAR_RIGHT_PARENTHESES:fi,CHAR_LEFT_CURLY_BRACE:gi,CHAR_RIGHT_CURLY_BRACE:mi,CHAR_LEFT_SQUARE_BRACKET:Ur,CHAR_RIGHT_SQUARE_BRACKET:Gr,CHAR_DOUBLE_QUOTE:wi,CHAR_SINGLE_QUOTE:vi,CHAR_NO_BREAK_SPACE:yi,CHAR_ZERO_WIDTH_NOBREAK_SPACE:_i}=Br(),bi=(s,e={})=>{if(typeof s!="string")throw new TypeError("Expected a string");let t=e||{},r=typeof t.maxLength=="number"?Math.min(Wr,t.maxLength):Wr;if(s.length>r)throw new SyntaxError(`Input length (${s.length}), exceeds max characters (${r})`);let o={type:"root",input:s,nodes:[]},i=[o],n=o,a=o,c=0,h=s.length,u=0,p=0,l,f=()=>s[u++],w=y=>{if(y.type==="text"&&a.type==="dot"&&(a.type="text"),a&&a.type==="text"&&y.type==="text"){a.value+=y.value;return}return n.nodes.push(y),y.parent=n,y.prev=a,a=y,y};for(w({type:"bos"});u<h;)if(n=i[i.length-1],l=f(),!(l===_i||l===yi)){if(l===zt){w({type:"text",value:(e.keepEscaping?l:"")+f()});continue}if(l===Gr){w({type:"text",value:"\\"+l});continue}if(l===Ur){c++;let y;for(;u<h&&(y=f());){if(l+=y,y===Ur){c++;continue}if(y===zt){l+=f();continue}if(y===Gr&&(c--,c===0))break}w({type:"text",value:l});continue}if(l===hi){n=w({type:"paren",nodes:[]}),i.push(n),w({type:"text",value:l});continue}if(l===fi){if(n.type!=="paren"){w({type:"text",value:l});continue}n=i.pop(),w({type:"text",value:l}),n=i[i.length-1];continue}if(l===wi||l===vi||l===di){let y=l,E;for(e.keepQuotes!==!0&&(l="");u<h&&(E=f());){if(E===zt){l+=E+f();continue}if(E===y){e.keepQuotes===!0&&(l+=E);break}l+=E}w({type:"text",value:l});continue}if(l===gi){p++;let E={type:"brace",open:!0,close:!1,dollar:a.value&&a.value.slice(-1)==="$"||n.dollar===!0,depth:p,commas:0,ranges:0,nodes:[]};n=w(E),i.push(n),w({type:"open",value:l});continue}if(l===mi){if(n.type!=="brace"){w({type:"text",value:l});continue}let y="close";n=i.pop(),n.close=!0,w({type:y,value:l}),p--,n=i[i.length-1];continue}if(l===ui&&p>0){if(n.ranges>0){n.ranges=0;let y=n.nodes.shift();n.nodes=[y,{type:"text",value:li(n)}]}w({type:"comma",value:l}),n.commas++;continue}if(l===pi&&p>0&&n.commas===0){let y=n.nodes;if(p===0||y.length===0){w({type:"text",value:l});continue}if(a.type==="dot"){if(n.range=[],a.value+=l,a.type="range",n.nodes.length!==3&&n.nodes.length!==5){n.invalid=!0,n.ranges=0,a.type="text";continue}n.ranges++,n.args=[];continue}if(a.type==="range"){y.pop();let E=y[y.length-1];E.value+=a.value+l,a=E,n.ranges--;continue}w({type:"dot",value:l});continue}w({type:"text",value:l})}do if(n=i.pop(),n.type!=="root"){n.nodes.forEach(A=>{A.nodes||(A.type==="open"&&(A.isOpen=!0),A.type==="close"&&(A.isClose=!0),A.nodes||(A.type="text"),A.invalid=!0)});let y=i[i.length-1],E=y.nodes.indexOf(n);y.nodes.splice(E,1,...n.nodes)}while(i.length>0);return w({type:"eos"}),o};qr.exports=bi});var Yr=L((Rc,Vr)=>{"use strict";var zr=nt(),Ei=Lr(),Ri=Nr(),xi=Kr(),oe=(s,e={})=>{let t=[];if(Array.isArray(s))for(let r of s){let o=oe.create(r,e);Array.isArray(o)?t.push(...o):t.push(o)}else t=[].concat(oe.create(s,e));return e&&e.expand===!0&&e.nodupes===!0&&(t=[...new Set(t)]),t};oe.parse=(s,e={})=>xi(s,e);oe.stringify=(s,e={})=>zr(typeof s=="string"?oe.parse(s,e):s,e);oe.compile=(s,e={})=>(typeof s=="string"&&(s=oe.parse(s,e)),Ei(s,e));oe.expand=(s,e={})=>{typeof s=="string"&&(s=oe.parse(s,e));let t=Ri(s,e);return e.noempty===!0&&(t=t.filter(Boolean)),e.nodupes===!0&&(t=[...new Set(t)]),t};oe.create=(s,e={})=>s===""||s.length<3?[s]:e.expand!==!0?oe.compile(s,e):oe.expand(s,e);Vr.exports=oe});var Qr=L((xc,Si)=>{Si.exports=["3dm","3ds","3g2","3gp","7z","a","aac","adp","afdesign","afphoto","afpub","ai","aif","aiff","alz","ape","apk","appimage","ar","arj","asf","au","avi","bak","baml","bh","bin","bk","bmp","btif","bz2","bzip2","cab","caf","cgm","class","cmx","cpio","cr2","cur","dat","dcm","deb","dex","djvu","dll","dmg","dng","doc","docm","docx","dot","dotm","dra","DS_Store","dsk","dts","dtshd","dvb","dwg","dxf","ecelp4800","ecelp7470","ecelp9600","egg","eol","eot","epub","exe","f4v","fbs","fh","fla","flac","flatpak","fli","flv","fpx","fst","fvt","g3","gh","gif","graffle","gz","gzip","h261","h263","h264","icns","ico","ief","img","ipa","iso","jar","jpeg","jpg","jpgv","jpm","jxr","key","ktx","lha","lib","lvp","lz","lzh","lzma","lzo","m3u","m4a","m4v","mar","mdi","mht","mid","midi","mj2","mka","mkv","mmr","mng","mobi","mov","movie","mp3","mp4","mp4a","mpeg","mpg","mpga","mxu","nef","npx","numbers","nupkg","o","odp","ods","odt","oga","ogg","ogv","otf","ott","pages","pbm","pcx","pdb","pdf","pea","pgm","pic","png","pnm","pot","potm","potx","ppa","ppam","ppm","pps","ppsm","ppsx","ppt","pptm","pptx","psd","pya","pyc","pyo","pyv","qt","rar","ras","raw","resources","rgb","rip","rlc","rmf","rmvb","rpm","rtf","rz","s3m","s7z","scpt","sgi","shar","snap","sil","sketch","slk","smv","snk","so","stl","suo","sub","swf","tar","tbz","tbz2","tga","tgz","thmx","tif","tiff","tlz","ttc","ttf","txz","udf","uvh","uvi","uvm","uvp","uvs","uvu","viv","vob","war","wav","wax","wbmp","wdp","weba","webm","webp","whl","wim","wm","wma","wmv","wmx","woff","woff2","wrm","wvx","xbm","xif","xla","xlam","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx","xm","xmind","xpi","xpm","xwd","xz","z","zip","zipx"]});var Zr=L((Sc,Xr)=>{Xr.exports=Qr()});var eo=L((Ac,Jr)=>{"use strict";var Ai=require("path"),Ci=Zr(),Pi=new Set(Ci);Jr.exports=s=>Pi.has(Ai.extname(s).slice(1).toLowerCase())});var ct=L(R=>{"use strict";var{sep:ki}=require("path"),{platform:Vt}=process,Ti=require("os");R.EV_ALL="all";R.EV_READY="ready";R.EV_ADD="add";R.EV_CHANGE="change";R.EV_ADD_DIR="addDir";R.EV_UNLINK="unlink";R.EV_UNLINK_DIR="unlinkDir";R.EV_RAW="raw";R.EV_ERROR="error";R.STR_DATA="data";R.STR_END="end";R.STR_CLOSE="close";R.FSEVENT_CREATED="created";R.FSEVENT_MODIFIED="modified";R.FSEVENT_DELETED="deleted";R.FSEVENT_MOVED="moved";R.FSEVENT_CLONED="cloned";R.FSEVENT_UNKNOWN="unknown";R.FSEVENT_FLAG_MUST_SCAN_SUBDIRS=1;R.FSEVENT_TYPE_FILE="file";R.FSEVENT_TYPE_DIRECTORY="directory";R.FSEVENT_TYPE_SYMLINK="symlink";R.KEY_LISTENERS="listeners";R.KEY_ERR="errHandlers";R.KEY_RAW="rawEmitters";R.HANDLER_KEYS=[R.KEY_LISTENERS,R.KEY_ERR,R.KEY_RAW];R.DOT_SLASH=`.${ki}`;R.BACK_SLASH_RE=/\\/g;R.DOUBLE_SLASH_RE=/\/\//;R.SLASH_OR_BACK_SLASH_RE=/[/\\]/;R.DOT_RE=/\..*\.(sw[px])$|~$|\.subl.*\.tmp/;R.REPLACER_RE=/^\.[/\\]/;R.SLASH="/";R.SLASH_SLASH="//";R.BRACE_START="{";R.BANG="!";R.ONE_DOT=".";R.TWO_DOTS="..";R.STAR="*";R.GLOBSTAR="**";R.ROOT_GLOBSTAR="/**/*";R.SLASH_GLOBSTAR="/**";R.DIR_SUFFIX="Dir";R.ANYMATCH_OPTS={dot:!0};R.STRING_TYPE="string";R.FUNCTION_TYPE="function";R.EMPTY_STR="";R.EMPTY_FN=()=>{};R.IDENTITY_FN=s=>s;R.isWindows=Vt==="win32";R.isMacos=Vt==="darwin";R.isLinux=Vt==="linux";R.isIBMi=Ti.type()==="OS400"});var io=L((Pc,no)=>{"use strict";var fe=require("fs"),V=require("path"),{promisify:Le}=require("util"),Ii=eo(),{isWindows:Mi,isLinux:Di,EMPTY_FN:$i,EMPTY_STR:Fi,KEY_LISTENERS:xe,KEY_ERR:Yt,KEY_RAW:De,HANDLER_KEYS:Li,EV_CHANGE:dt,EV_ADD:lt,EV_ADD_DIR:Hi,EV_ERROR:so,STR_DATA:Oi,STR_END:Ni,BRACE_START:ji,STAR:Bi}=ct(),Wi="watch",Ui=Le(fe.open),ro=Le(fe.stat),Gi=Le(fe.lstat),qi=Le(fe.close),Qt=Le(fe.realpath),Ki={lstat:Gi,stat:ro},Zt=(s,e)=>{s instanceof Set?s.forEach(e):e(s)},$e=(s,e,t)=>{let r=s[e];r instanceof Set||(s[e]=r=new Set([r])),r.add(t)},zi=s=>e=>{let t=s[e];t instanceof Set?t.clear():delete s[e]},Fe=(s,e,t)=>{let r=s[e];r instanceof Set?r.delete(t):r===t&&delete s[e]},oo=s=>s instanceof Set?s.size===0:!s,ut=new Map;function to(s,e,t,r,o){let i=(n,a)=>{t(s),o(n,a,{watchedPath:s}),a&&s!==a&&pt(V.resolve(s,a),xe,V.join(s,a))};try{return fe.watch(s,e,i)}catch(n){r(n)}}var pt=(s,e,t,r,o)=>{let i=ut.get(s);i&&Zt(i[e],n=>{n(t,r,o)})},Vi=(s,e,t,r)=>{let{listener:o,errHandler:i,rawEmitter:n}=r,a=ut.get(e),c;if(!t.persistent)return c=to(s,t,o,i,n),c.close.bind(c);if(a)$e(a,xe,o),$e(a,Yt,i),$e(a,De,n);else{if(c=to(s,t,pt.bind(null,e,xe),i,pt.bind(null,e,De)),!c)return;c.on(so,async h=>{let u=pt.bind(null,e,Yt);if(a.watcherUnusable=!0,Mi&&h.code==="EPERM")try{let p=await Ui(s,"r");await qi(p),u(h)}catch{}else u(h)}),a={listeners:o,errHandlers:i,rawEmitters:n,watcher:c},ut.set(e,a)}return()=>{Fe(a,xe,o),Fe(a,Yt,i),Fe(a,De,n),oo(a.listeners)&&(a.watcher.close(),ut.delete(e),Li.forEach(zi(a)),a.watcher=void 0,Object.freeze(a))}},Xt=new Map,Yi=(s,e,t,r)=>{let{listener:o,rawEmitter:i}=r,n=Xt.get(e),a=new Set,c=new Set,h=n&&n.options;return h&&(h.persistent<t.persistent||h.interval>t.interval)&&(a=n.listeners,c=n.rawEmitters,fe.unwatchFile(e),n=void 0),n?($e(n,xe,o),$e(n,De,i)):(n={listeners:o,rawEmitters:i,options:t,watcher:fe.watchFile(e,t,(u,p)=>{Zt(n.rawEmitters,f=>{f(dt,e,{curr:u,prev:p})});let l=u.mtimeMs;(u.size!==p.size||l>p.mtimeMs||l===0)&&Zt(n.listeners,f=>f(s,u))})},Xt.set(e,n)),()=>{Fe(n,xe,o),Fe(n,De,i),oo(n.listeners)&&(Xt.delete(e),fe.unwatchFile(e),n.options=n.watcher=void 0,Object.freeze(n))}},Jt=class{constructor(e){this.fsw=e,this._boundHandleError=t=>e._handleError(t)}_watchWithNodeFs(e,t){let r=this.fsw.options,o=V.dirname(e),i=V.basename(e);this.fsw._getWatchedDir(o).add(i);let a=V.resolve(e),c={persistent:r.persistent};t||(t=$i);let h;return r.usePolling?(c.interval=r.enableBinaryInterval&&Ii(i)?r.binaryInterval:r.interval,h=Yi(e,a,c,{listener:t,rawEmitter:this.fsw._emitRaw})):h=Vi(e,a,c,{listener:t,errHandler:this._boundHandleError,rawEmitter:this.fsw._emitRaw}),h}_handleFile(e,t,r){if(this.fsw.closed)return;let o=V.dirname(e),i=V.basename(e),n=this.fsw._getWatchedDir(o),a=t;if(n.has(i))return;let c=async(u,p)=>{if(this.fsw._throttle(Wi,e,5)){if(!p||p.mtimeMs===0)try{let l=await ro(e);if(this.fsw.closed)return;let f=l.atimeMs,w=l.mtimeMs;(!f||f<=w||w!==a.mtimeMs)&&this.fsw._emit(dt,e,l),Di&&a.ino!==l.ino?(this.fsw._closeFile(u),a=l,this.fsw._addPathCloser(u,this._watchWithNodeFs(e,c))):a=l}catch{this.fsw._remove(o,i)}else if(n.has(i)){let l=p.atimeMs,f=p.mtimeMs;(!l||l<=f||f!==a.mtimeMs)&&this.fsw._emit(dt,e,p),a=p}}},h=this._watchWithNodeFs(e,c);if(!(r&&this.fsw.options.ignoreInitial)&&this.fsw._isntIgnored(e)){if(!this.fsw._throttle(lt,e,0))return;this.fsw._emit(lt,e,t)}return h}async _handleSymlink(e,t,r,o){if(this.fsw.closed)return;let i=e.fullPath,n=this.fsw._getWatchedDir(t);if(!this.fsw.options.followSymlinks){this.fsw._incrReadyCount();let a;try{a=await Qt(r)}catch{return this.fsw._emitReady(),!0}return this.fsw.closed?void 0:(n.has(o)?this.fsw._symlinkPaths.get(i)!==a&&(this.fsw._symlinkPaths.set(i,a),this.fsw._emit(dt,r,e.stats)):(n.add(o),this.fsw._symlinkPaths.set(i,a),this.fsw._emit(lt,r,e.stats)),this.fsw._emitReady(),!0)}if(this.fsw._symlinkPaths.has(i))return!0;this.fsw._symlinkPaths.set(i,!0)}_handleRead(e,t,r,o,i,n,a){if(e=V.join(e,Fi),!r.hasGlob&&(a=this.fsw._throttle("readdir",e,1e3),!a))return;let c=this.fsw._getWatchedDir(r.path),h=new Set,u=this.fsw._readdirp(e,{fileFilter:p=>r.filterPath(p),directoryFilter:p=>r.filterDir(p),depth:0}).on(Oi,async p=>{if(this.fsw.closed){u=void 0;return}let l=p.path,f=V.join(e,l);if(h.add(l),!(p.stats.isSymbolicLink()&&await this._handleSymlink(p,e,f,l))){if(this.fsw.closed){u=void 0;return}(l===o||!o&&!c.has(l))&&(this.fsw._incrReadyCount(),f=V.join(i,V.relative(i,f)),this._addToNodeFs(f,t,r,n+1))}}).on(so,this._boundHandleError);return new Promise(p=>u.once(Ni,()=>{if(this.fsw.closed){u=void 0;return}let l=a?a.clear():!1;p(),c.getChildren().filter(f=>f!==e&&!h.has(f)&&(!r.hasGlob||r.filterPath({fullPath:V.resolve(e,f)}))).forEach(f=>{this.fsw._remove(e,f)}),u=void 0,l&&this._handleRead(e,!1,r,o,i,n,a)}))}async _handleDir(e,t,r,o,i,n,a){let c=this.fsw._getWatchedDir(V.dirname(e)),h=c.has(V.basename(e));!(r&&this.fsw.options.ignoreInitial)&&!i&&!h&&(!n.hasGlob||n.globFilter(e))&&this.fsw._emit(Hi,e,t),c.add(V.basename(e)),this.fsw._getWatchedDir(e);let u,p,l=this.fsw.options.depth;if((l==null||o<=l)&&!this.fsw._symlinkPaths.has(a)){if(!i&&(await this._handleRead(e,r,n,i,e,o,u),this.fsw.closed))return;p=this._watchWithNodeFs(e,(f,w)=>{w&&w.mtimeMs===0||this._handleRead(f,!1,n,i,e,o,u)})}return p}async _addToNodeFs(e,t,r,o,i){let n=this.fsw._emitReady;if(this.fsw._isIgnored(e)||this.fsw.closed)return n(),!1;let a=this.fsw._getWatchHelpers(e,o);!a.hasGlob&&r&&(a.hasGlob=r.hasGlob,a.globFilter=r.globFilter,a.filterPath=c=>r.filterPath(c),a.filterDir=c=>r.filterDir(c));try{let c=await Ki[a.statMethod](a.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(a.watchPath,c))return n(),!1;let h=this.fsw.options.followSymlinks&&!e.includes(Bi)&&!e.includes(ji),u;if(c.isDirectory()){let p=V.resolve(e),l=h?await Qt(e):e;if(this.fsw.closed||(u=await this._handleDir(a.watchPath,c,t,o,i,a,l),this.fsw.closed))return;p!==l&&l!==void 0&&this.fsw._symlinkPaths.set(p,l)}else if(c.isSymbolicLink()){let p=h?await Qt(e):e;if(this.fsw.closed)return;let l=V.dirname(a.watchPath);if(this.fsw._getWatchedDir(l).add(a.watchPath),this.fsw._emit(lt,a.watchPath,c),u=await this._handleDir(l,c,t,o,e,a,p),this.fsw.closed)return;p!==void 0&&this.fsw._symlinkPaths.set(V.resolve(e),p)}else u=this._handleFile(a.watchPath,c,t);return n(),this.fsw._addPathCloser(e,u),!1}catch(c){if(this.fsw._handleError(c))return n(),e}}};no.exports=Jt});var fo=L((kc,as)=>{"use strict";var ns=require("fs"),Y=require("path"),{promisify:is}=require("util"),Se;try{Se=require("fsevents")}catch(s){process.env.CHOKIDAR_PRINT_FSEVENTS_REQUIRE_ERROR&&console.error(s)}if(Se){let s=process.version.match(/v(\d+)\.(\d+)/);if(s&&s[1]&&s[2]){let e=Number.parseInt(s[1],10),t=Number.parseInt(s[2],10);e===8&&t<16&&(Se=void 0)}}var{EV_ADD:es,EV_CHANGE:Qi,EV_ADD_DIR:ao,EV_UNLINK:ht,EV_ERROR:Xi,STR_DATA:Zi,STR_END:Ji,FSEVENT_CREATED:ea,FSEVENT_MODIFIED:ta,FSEVENT_DELETED:sa,FSEVENT_MOVED:ra,FSEVENT_UNKNOWN:oa,FSEVENT_FLAG_MUST_SCAN_SUBDIRS:na,FSEVENT_TYPE_FILE:ia,FSEVENT_TYPE_DIRECTORY:He,FSEVENT_TYPE_SYMLINK:ho,ROOT_GLOBSTAR:co,DIR_SUFFIX:aa,DOT_SLASH:lo,FUNCTION_TYPE:ts,EMPTY_FN:ca,IDENTITY_FN:la}=ct(),da=s=>isNaN(s)?{}:{depth:s},rs=is(ns.stat),ua=is(ns.lstat),uo=is(ns.realpath),pa={stat:rs,lstat:ua},ye=new Map,ha=10,fa=new Set([69888,70400,71424,72704,73472,131328,131840,262912]),ga=(s,e)=>({stop:Se.watch(s,e)});function ma(s,e,t,r){let o=Y.extname(e)?Y.dirname(e):e,i=Y.dirname(o),n=ye.get(o);wa(i)&&(o=i);let a=Y.resolve(s),c=a!==e,h=(p,l,f)=>{c&&(p=p.replace(e,a)),(p===a||!p.indexOf(a+Y.sep))&&t(p,l,f)},u=!1;for(let p of ye.keys())if(e.indexOf(Y.resolve(p)+Y.sep)===0){o=p,n=ye.get(o),u=!0;break}return n||u?n.listeners.add(h):(n={listeners:new Set([h]),rawEmitter:r,watcher:ga(o,(p,l)=>{if(!n.listeners.size||l&na)return;let f=Se.getInfo(p,l);n.listeners.forEach(w=>{w(p,l,f)}),n.rawEmitter(f.event,p,f)})},ye.set(o,n)),()=>{let p=n.listeners;if(p.delete(h),!p.size&&(ye.delete(o),n.watcher))return n.watcher.stop().then(()=>{n.rawEmitter=n.watcher=void 0,Object.freeze(n)})}}var wa=s=>{let e=0;for(let t of ye.keys())if(t.indexOf(s)===0&&(e++,e>=ha))return!0;return!1},va=()=>Se&&ye.size<128,ss=(s,e)=>{let t=0;for(;!s.indexOf(e)&&(s=Y.dirname(s))!==e;)t++;return t},po=(s,e)=>s.type===He&&e.isDirectory()||s.type===ho&&e.isSymbolicLink()||s.type===ia&&e.isFile(),os=class{constructor(e){this.fsw=e}checkIgnored(e,t){let r=this.fsw._ignoredPaths;if(this.fsw._isIgnored(e,t))return r.add(e),t&&t.isDirectory()&&r.add(e+co),!0;r.delete(e),r.delete(e+co)}addOrChange(e,t,r,o,i,n,a,c){let h=i.has(n)?Qi:es;this.handleEvent(h,e,t,r,o,i,n,a,c)}async checkExists(e,t,r,o,i,n,a,c){try{let h=await rs(e);if(this.fsw.closed)return;po(a,h)?this.addOrChange(e,t,r,o,i,n,a,c):this.handleEvent(ht,e,t,r,o,i,n,a,c)}catch(h){h.code==="EACCES"?this.addOrChange(e,t,r,o,i,n,a,c):this.handleEvent(ht,e,t,r,o,i,n,a,c)}}handleEvent(e,t,r,o,i,n,a,c,h){if(!(this.fsw.closed||this.checkIgnored(t)))if(e===ht){let u=c.type===He;(u||n.has(a))&&this.fsw._remove(i,a,u)}else{if(e===es){if(c.type===He&&this.fsw._getWatchedDir(t),c.type===ho&&h.followSymlinks){let p=h.depth===void 0?void 0:ss(r,o)+1;return this._addToFsEvents(t,!1,!0,p)}this.fsw._getWatchedDir(i).add(a)}let u=c.type===He?e+aa:e;this.fsw._emit(u,t),u===ao&&this._addToFsEvents(t,!1,!0)}}_watchWithFsEvents(e,t,r,o){if(this.fsw.closed||this.fsw._isIgnored(e))return;let i=this.fsw.options,a=ma(e,t,async(c,h,u)=>{if(this.fsw.closed||i.depth!==void 0&&ss(c,t)>i.depth)return;let p=r(Y.join(e,Y.relative(e,c)));if(o&&!o(p))return;let l=Y.dirname(p),f=Y.basename(p),w=this.fsw._getWatchedDir(u.type===He?p:l);if(fa.has(h)||u.event===oa)if(typeof i.ignored===ts){let y;try{y=await rs(p)}catch{}if(this.fsw.closed||this.checkIgnored(p,y))return;po(u,y)?this.addOrChange(p,c,t,l,w,f,u,i):this.handleEvent(ht,p,c,t,l,w,f,u,i)}else this.checkExists(p,c,t,l,w,f,u,i);else switch(u.event){case ea:case ta:return this.addOrChange(p,c,t,l,w,f,u,i);case sa:case ra:return this.checkExists(p,c,t,l,w,f,u,i)}},this.fsw._emitRaw);return this.fsw._emitReady(),a}async _handleFsEventsSymlink(e,t,r,o){if(!(this.fsw.closed||this.fsw._symlinkPaths.has(t))){this.fsw._symlinkPaths.set(t,!0),this.fsw._incrReadyCount();try{let i=await uo(e);if(this.fsw.closed)return;if(this.fsw._isIgnored(i))return this.fsw._emitReady();this.fsw._incrReadyCount(),this._addToFsEvents(i||e,n=>{let a=e;return i&&i!==lo?a=n.replace(i,e):n!==lo&&(a=Y.join(e,n)),r(a)},!1,o)}catch(i){if(this.fsw._handleError(i))return this.fsw._emitReady()}}}emitAdd(e,t,r,o,i){let n=r(e),a=t.isDirectory(),c=this.fsw._getWatchedDir(Y.dirname(n)),h=Y.basename(n);a&&this.fsw._getWatchedDir(n),!c.has(h)&&(c.add(h),(!o.ignoreInitial||i===!0)&&this.fsw._emit(a?ao:es,n,t))}initWatch(e,t,r,o){if(this.fsw.closed)return;let i=this._watchWithFsEvents(r.watchPath,Y.resolve(e||r.watchPath),o,r.globFilter);this.fsw._addPathCloser(t,i)}async _addToFsEvents(e,t,r,o){if(this.fsw.closed)return;let i=this.fsw.options,n=typeof t===ts?t:la,a=this.fsw._getWatchHelpers(e);try{let c=await pa[a.statMethod](a.watchPath);if(this.fsw.closed)return;if(this.fsw._isIgnored(a.watchPath,c))throw null;if(c.isDirectory()){if(a.globFilter||this.emitAdd(n(e),c,n,i,r),o&&o>i.depth)return;this.fsw._readdirp(a.watchPath,{fileFilter:h=>a.filterPath(h),directoryFilter:h=>a.filterDir(h),...da(i.depth-(o||0))}).on(Zi,h=>{if(this.fsw.closed||h.stats.isDirectory()&&!a.filterPath(h))return;let u=Y.join(a.watchPath,h.path),{fullPath:p}=h;if(a.followSymlinks&&h.stats.isSymbolicLink()){let l=i.depth===void 0?void 0:ss(u,Y.resolve(a.watchPath))+1;this._handleFsEventsSymlink(u,p,n,l)}else this.emitAdd(u,h.stats,n,i,r)}).on(Xi,ca).on(Ji,()=>{this.fsw._emitReady()})}else this.emitAdd(a.watchPath,c,n,i,r),this.fsw._emitReady()}catch(c){(!c||this.fsw._handleError(c))&&(this.fsw._emitReady(),this.fsw._emitReady())}if(i.persistent&&r!==!0)if(typeof t===ts)this.initWatch(void 0,e,a,n);else{let c;try{c=await uo(a.watchPath)}catch{}this.initWatch(c,e,a,n)}}};as.exports=os;as.exports.canUse=va});var Rs=L(Es=>{"use strict";var{EventEmitter:ya}=require("events"),_s=require("fs"),H=require("path"),{promisify:bo}=require("util"),_a=er(),hs=ar().default,ba=hr(),cs=Bt(),Ea=Yr(),Ra=Nt(),xa=io(),go=fo(),{EV_ALL:ls,EV_READY:Sa,EV_ADD:ft,EV_CHANGE:Oe,EV_UNLINK:mo,EV_ADD_DIR:Aa,EV_UNLINK_DIR:Ca,EV_RAW:Pa,EV_ERROR:ds,STR_CLOSE:ka,STR_END:Ta,BACK_SLASH_RE:Ia,DOUBLE_SLASH_RE:wo,SLASH_OR_BACK_SLASH_RE:Ma,DOT_RE:Da,REPLACER_RE:$a,SLASH:us,SLASH_SLASH:Fa,BRACE_START:La,BANG:fs,ONE_DOT:Eo,TWO_DOTS:Ha,GLOBSTAR:Oa,SLASH_GLOBSTAR:ps,ANYMATCH_OPTS:gs,STRING_TYPE:bs,FUNCTION_TYPE:Na,EMPTY_STR:ms,EMPTY_FN:ja,isWindows:Ba,isMacos:Wa,isIBMi:Ua}=ct(),Ga=bo(_s.stat),qa=bo(_s.readdir),ws=(s=[])=>Array.isArray(s)?s:[s],Ro=(s,e=[])=>(s.forEach(t=>{Array.isArray(t)?Ro(t,e):e.push(t)}),e),vo=s=>{let e=Ro(ws(s));if(!e.every(t=>typeof t===bs))throw new TypeError(`Non-string provided as watch path: ${e}`);return e.map(xo)},yo=s=>{let e=s.replace(Ia,us),t=!1;for(e.startsWith(Fa)&&(t=!0);e.match(wo);)e=e.replace(wo,us);return t&&(e=us+e),e},xo=s=>yo(H.normalize(yo(s))),_o=(s=ms)=>e=>typeof e!==bs?e:xo(H.isAbsolute(e)?e:H.join(s,e)),Ka=(s,e)=>H.isAbsolute(s)?s:s.startsWith(fs)?fs+H.join(e,s.slice(1)):H.join(e,s),ce=(s,e)=>s[e]===void 0,vs=class{constructor(e,t){this.path=e,this._removeWatcher=t,this.items=new Set}add(e){let{items:t}=this;t&&e!==Eo&&e!==Ha&&t.add(e)}async remove(e){let{items:t}=this;if(!t||(t.delete(e),t.size>0))return;let r=this.path;try{await qa(r)}catch{this._removeWatcher&&this._removeWatcher(H.dirname(r),H.basename(r))}}has(e){let{items:t}=this;if(t)return t.has(e)}getChildren(){let{items:e}=this;if(e)return[...e.values()]}dispose(){this.items.clear(),delete this.path,delete this._removeWatcher,delete this.items,Object.freeze(this)}},za="stat",Va="lstat",ys=class{constructor(e,t,r,o){this.fsw=o,this.path=e=e.replace($a,ms),this.watchPath=t,this.fullWatchPath=H.resolve(t),this.hasGlob=t!==e,e===ms&&(this.hasGlob=!1),this.globSymlink=this.hasGlob&&r?void 0:!1,this.globFilter=this.hasGlob?hs(e,void 0,gs):!1,this.dirParts=this.getDirParts(e),this.dirParts.forEach(i=>{i.length>1&&i.pop()}),this.followSymlinks=r,this.statMethod=r?za:Va}checkGlobSymlink(e){return this.globSymlink===void 0&&(this.globSymlink=e.fullParentDir===this.fullWatchPath?!1:{realPath:e.fullParentDir,linkPath:this.fullWatchPath}),this.globSymlink?e.fullPath.replace(this.globSymlink.realPath,this.globSymlink.linkPath):e.fullPath}entryPath(e){return H.join(this.watchPath,H.relative(this.watchPath,this.checkGlobSymlink(e)))}filterPath(e){let{stats:t}=e;if(t&&t.isSymbolicLink())return this.filterDir(e);let r=this.entryPath(e);return(this.hasGlob&&typeof this.globFilter===Na?this.globFilter(r):!0)&&this.fsw._isntIgnored(r,t)&&this.fsw._hasReadPermissions(t)}getDirParts(e){if(!this.hasGlob)return[];let t=[];return(e.includes(La)?Ea.expand(e):[e]).forEach(o=>{t.push(H.relative(this.watchPath,o).split(Ma))}),t}filterDir(e){if(this.hasGlob){let t=this.getDirParts(this.checkGlobSymlink(e)),r=!1;this.unmatchedGlob=!this.dirParts.some(o=>o.every((i,n)=>(i===Oa&&(r=!0),r||!t[0][n]||hs(i,t[0][n],gs))))}return!this.unmatchedGlob&&this.fsw._isntIgnored(this.entryPath(e),e.stats)}},gt=class extends ya{constructor(e){super();let t={};e&&Object.assign(t,e),this._watched=new Map,this._closers=new Map,this._ignoredPaths=new Set,this._throttled=new Map,this._symlinkPaths=new Map,this._streams=new Set,this.closed=!1,ce(t,"persistent")&&(t.persistent=!0),ce(t,"ignoreInitial")&&(t.ignoreInitial=!1),ce(t,"ignorePermissionErrors")&&(t.ignorePermissionErrors=!1),ce(t,"interval")&&(t.interval=100),ce(t,"binaryInterval")&&(t.binaryInterval=300),ce(t,"disableGlobbing")&&(t.disableGlobbing=!1),t.enableBinaryInterval=t.binaryInterval!==t.interval,ce(t,"useFsEvents")&&(t.useFsEvents=!t.usePolling),go.canUse()||(t.useFsEvents=!1),ce(t,"usePolling")&&!t.useFsEvents&&(t.usePolling=Wa),Ua&&(t.usePolling=!0);let o=process.env.CHOKIDAR_USEPOLLING;if(o!==void 0){let c=o.toLowerCase();c==="false"||c==="0"?t.usePolling=!1:c==="true"||c==="1"?t.usePolling=!0:t.usePolling=!!c}let i=process.env.CHOKIDAR_INTERVAL;i&&(t.interval=Number.parseInt(i,10)),ce(t,"atomic")&&(t.atomic=!t.usePolling&&!t.useFsEvents),t.atomic&&(this._pendingUnlinks=new Map),ce(t,"followSymlinks")&&(t.followSymlinks=!0),ce(t,"awaitWriteFinish")&&(t.awaitWriteFinish=!1),t.awaitWriteFinish===!0&&(t.awaitWriteFinish={});let n=t.awaitWriteFinish;n&&(n.stabilityThreshold||(n.stabilityThreshold=2e3),n.pollInterval||(n.pollInterval=100),this._pendingWrites=new Map),t.ignored&&(t.ignored=ws(t.ignored));let a=0;this._emitReady=()=>{a++,a>=this._readyCount&&(this._emitReady=ja,this._readyEmitted=!0,process.nextTick(()=>this.emit(Sa)))},this._emitRaw=(...c)=>this.emit(Pa,...c),this._readyEmitted=!1,this.options=t,t.useFsEvents?this._fsEventsHandler=new go(this):this._nodeFsHandler=new xa(this),Object.freeze(t)}add(e,t,r){let{cwd:o,disableGlobbing:i}=this.options;this.closed=!1;let n=vo(e);return o&&(n=n.map(a=>{let c=Ka(a,o);return i||!cs(a)?c:Ra(c)})),n=n.filter(a=>a.startsWith(fs)?(this._ignoredPaths.add(a.slice(1)),!1):(this._ignoredPaths.delete(a),this._ignoredPaths.delete(a+ps),this._userIgnored=void 0,!0)),this.options.useFsEvents&&this._fsEventsHandler?(this._readyCount||(this._readyCount=n.length),this.options.persistent&&(this._readyCount+=n.length),n.forEach(a=>this._fsEventsHandler._addToFsEvents(a))):(this._readyCount||(this._readyCount=0),this._readyCount+=n.length,Promise.all(n.map(async a=>{let c=await this._nodeFsHandler._addToNodeFs(a,!r,0,0,t);return c&&this._emitReady(),c})).then(a=>{this.closed||a.filter(c=>c).forEach(c=>{this.add(H.dirname(c),H.basename(t||c))})})),this}unwatch(e){if(this.closed)return this;let t=vo(e),{cwd:r}=this.options;return t.forEach(o=>{!H.isAbsolute(o)&&!this._closers.has(o)&&(r&&(o=H.join(r,o)),o=H.resolve(o)),this._closePath(o),this._ignoredPaths.add(o),this._watched.has(o)&&this._ignoredPaths.add(o+ps),this._userIgnored=void 0}),this}close(){if(this.closed)return this._closePromise;this.closed=!0,this.removeAllListeners();let e=[];return this._closers.forEach(t=>t.forEach(r=>{let o=r();o instanceof Promise&&e.push(o)})),this._streams.forEach(t=>t.destroy()),this._userIgnored=void 0,this._readyCount=0,this._readyEmitted=!1,this._watched.forEach(t=>t.dispose()),["closers","watched","streams","symlinkPaths","throttled"].forEach(t=>{this[`_${t}`].clear()}),this._closePromise=e.length?Promise.all(e).then(()=>{}):Promise.resolve(),this._closePromise}getWatched(){let e={};return this._watched.forEach((t,r)=>{let o=this.options.cwd?H.relative(this.options.cwd,r):r;e[o||Eo]=t.getChildren().sort()}),e}emitWithAll(e,t){this.emit(...t),e!==ds&&this.emit(ls,...t)}async _emit(e,t,r,o,i){if(this.closed)return;let n=this.options;Ba&&(t=H.normalize(t)),n.cwd&&(t=H.relative(n.cwd,t));let a=[e,t];i!==void 0?a.push(r,o,i):o!==void 0?a.push(r,o):r!==void 0&&a.push(r);let c=n.awaitWriteFinish,h;if(c&&(h=this._pendingWrites.get(t)))return h.lastChange=new Date,this;if(n.atomic){if(e===mo)return this._pendingUnlinks.set(t,a),setTimeout(()=>{this._pendingUnlinks.forEach((u,p)=>{this.emit(...u),this.emit(ls,...u),this._pendingUnlinks.delete(p)})},typeof n.atomic=="number"?n.atomic:100),this;e===ft&&this._pendingUnlinks.has(t)&&(e=a[0]=Oe,this._pendingUnlinks.delete(t))}if(c&&(e===ft||e===Oe)&&this._readyEmitted){let u=(p,l)=>{p?(e=a[0]=ds,a[1]=p,this.emitWithAll(e,a)):l&&(a.length>2?a[2]=l:a.push(l),this.emitWithAll(e,a))};return this._awaitWriteFinish(t,c.stabilityThreshold,e,u),this}if(e===Oe&&!this._throttle(Oe,t,50))return this;if(n.alwaysStat&&r===void 0&&(e===ft||e===Aa||e===Oe)){let u=n.cwd?H.join(n.cwd,t):t,p;try{p=await Ga(u)}catch{}if(!p||this.closed)return;a.push(p)}return this.emitWithAll(e,a),this}_handleError(e){let t=e&&e.code;return e&&t!=="ENOENT"&&t!=="ENOTDIR"&&(!this.options.ignorePermissionErrors||t!=="EPERM"&&t!=="EACCES")&&this.emit(ds,e),e||this.closed}_throttle(e,t,r){this._throttled.has(e)||this._throttled.set(e,new Map);let o=this._throttled.get(e),i=o.get(t);if(i)return i.count++,!1;let n,a=()=>{let h=o.get(t),u=h?h.count:0;return o.delete(t),clearTimeout(n),h&&clearTimeout(h.timeoutObject),u};n=setTimeout(a,r);let c={timeoutObject:n,clear:a,count:0};return o.set(t,c),c}_incrReadyCount(){return this._readyCount++}_awaitWriteFinish(e,t,r,o){let i,n=e;this.options.cwd&&!H.isAbsolute(e)&&(n=H.join(this.options.cwd,e));let a=new Date,c=h=>{_s.stat(n,(u,p)=>{if(u||!this._pendingWrites.has(e)){u&&u.code!=="ENOENT"&&o(u);return}let l=Number(new Date);h&&p.size!==h.size&&(this._pendingWrites.get(e).lastChange=l);let f=this._pendingWrites.get(e);l-f.lastChange>=t?(this._pendingWrites.delete(e),o(void 0,p)):i=setTimeout(c,this.options.awaitWriteFinish.pollInterval,p)})};this._pendingWrites.has(e)||(this._pendingWrites.set(e,{lastChange:a,cancelWait:()=>(this._pendingWrites.delete(e),clearTimeout(i),r)}),i=setTimeout(c,this.options.awaitWriteFinish.pollInterval))}_getGlobIgnored(){return[...this._ignoredPaths.values()]}_isIgnored(e,t){if(this.options.atomic&&Da.test(e))return!0;if(!this._userIgnored){let{cwd:r}=this.options,o=this.options.ignored,i=o&&o.map(_o(r)),n=ws(i).filter(c=>typeof c===bs&&!cs(c)).map(c=>c+ps),a=this._getGlobIgnored().map(_o(r)).concat(i,n);this._userIgnored=hs(a,void 0,gs)}return this._userIgnored([e,t])}_isntIgnored(e,t){return!this._isIgnored(e,t)}_getWatchHelpers(e,t){let r=t||this.options.disableGlobbing||!cs(e)?e:ba(e),o=this.options.followSymlinks;return new ys(e,r,o,this)}_getWatchedDir(e){this._boundRemove||(this._boundRemove=this._remove.bind(this));let t=H.resolve(e);return this._watched.has(t)||this._watched.set(t,new vs(t,this._boundRemove)),this._watched.get(t)}_hasReadPermissions(e){if(this.options.ignorePermissionErrors)return!0;let r=(e&&Number.parseInt(e.mode,10))&511;return!!(4&Number.parseInt(r.toString(8)[0],10))}_remove(e,t,r){let o=H.join(e,t),i=H.resolve(o);if(r=r??(this._watched.has(o)||this._watched.has(i)),!this._throttle("remove",o,100))return;!r&&!this.options.useFsEvents&&this._watched.size===1&&this.add(e,t,!0),this._getWatchedDir(o).getChildren().forEach(l=>this._remove(o,l));let c=this._getWatchedDir(e),h=c.has(t);c.remove(t),this._symlinkPaths.has(i)&&this._symlinkPaths.delete(i);let u=o;if(this.options.cwd&&(u=H.relative(this.options.cwd,o)),this.options.awaitWriteFinish&&this._pendingWrites.has(u)&&this._pendingWrites.get(u).cancelWait()===ft)return;this._watched.delete(o),this._watched.delete(i);let p=r?Ca:mo;h&&!this._isIgnored(o)&&this._emit(p,o),this.options.useFsEvents||this._closePath(o)}_closePath(e){this._closeFile(e);let t=H.dirname(e);this._getWatchedDir(t).remove(H.basename(e))}_closeFile(e){let t=this._closers.get(e);t&&(t.forEach(r=>r()),this._closers.delete(e))}_addPathCloser(e,t){if(!t)return;let r=this._closers.get(e);r||(r=[],this._closers.set(e,r)),r.push(t)}_readdirp(e,t){if(this.closed)return;let r={type:ls,alwaysStat:!0,lstat:!0,...t},o=_a(e,r);return this._streams.add(o),o.once(ka,()=>{o=void 0}),o.once(Ta,()=>{o&&(this._streams.delete(o),o=void 0)}),o}};Es.FSWatcher=gt;var Ya=(s,e)=>{let t=new gt(e);return t.add(s),t};Es.watch=Ya});var ec={};Ho(ec,{activate:()=>Xa,deactivate:()=>Za});module.exports=Oo(ec);var d=z(require("vscode"));var U=z(require("vscode")),Cs=z(require("crypto")),Ye=z(require("path")),Ve=class{constructor(e,t,r){this._extensionUri=e;this._dataRoot=t,this._agentsRoot=r}static viewType="projectMemory.dashboardView";_view;_dataRoot;_agentsRoot;_disposables=[];dispose(){for(;this._disposables.length;){let e=this._disposables.pop();e&&e.dispose()}}getWorkspaceId(){let e=U.workspace.workspaceFolders?.[0];if(!e)return null;let t=e.uri.fsPath,r=Ye.normalize(t).toLowerCase(),o=Cs.createHash("sha256").update(r).digest("hex").substring(0,12);return`${Ye.basename(t).replace(/[^a-zA-Z0-9-_]/g,"-")}-${o}`}resolveWebviewView(e,t,r){this.dispose(),this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[U.Uri.joinPath(this._extensionUri,"webview","dist"),U.Uri.joinPath(this._extensionUri,"resources")]},e.webview.html=this._getHtmlForWebview(e.webview),this._disposables.push(e.onDidDispose(()=>{this._view=void 0})),this._disposables.push(e.webview.onDidReceiveMessage(async o=>{switch(console.log("Received message from webview:",o),o.type){case"openFile":let{filePath:i,line:n}=o.data;U.commands.executeCommand("projectMemory.openFile",i,n);break;case"runCommand":let{command:a}=o.data;console.log("Executing command:",a);try{await U.commands.executeCommand(a),console.log("Command executed successfully")}catch(E){console.error("Command execution failed:",E),U.window.showErrorMessage(`Command failed: ${E}`)}break;case"openExternal":let{url:c}=o.data;console.log("Opening dashboard panel:",c),U.commands.executeCommand("projectMemory.openDashboardPanel",c);break;case"openPlan":let{planId:h,workspaceId:u}=o.data,p=`http://localhost:5173/workspace/${u}/plan/${h}`;console.log("Opening plan:",p),U.commands.executeCommand("projectMemory.openDashboardPanel",p);break;case"copyToClipboard":let{text:l}=o.data;await U.env.clipboard.writeText(l),U.window.showInformationMessage(`Copied to clipboard: ${l}`);break;case"showNotification":let{level:f,text:w}=o.data;f==="error"?U.window.showErrorMessage(w):f==="warning"?U.window.showWarningMessage(w):U.window.showInformationMessage(w);break;case"revealInExplorer":let{path:y}=o.data;U.commands.executeCommand("revealInExplorer",U.Uri.file(y));break;case"getConfig":this.postMessage({type:"config",data:{dataRoot:this._dataRoot,agentsRoot:this._agentsRoot,workspaceFolders:U.workspace.workspaceFolders?.map(E=>({name:E.name,path:E.uri.fsPath}))||[]}});break;case"ready":this.postMessage({type:"init",data:{dataRoot:this._dataRoot,agentsRoot:this._agentsRoot}});break}}))}postMessage(e){this._view&&this._view.webview.postMessage(e)}updateConfig(e,t){this._dataRoot=e,this._agentsRoot=t,this.postMessage({type:"configUpdated",data:{dataRoot:e,agentsRoot:t}})}_getHtmlForWebview(e){let t=No(),r=U.workspace.getConfiguration("projectMemory"),o=r.get("serverPort")||r.get("apiPort")||3001,i="http://localhost:5173",n=this.getWorkspaceId()||"",a=U.workspace.workspaceFolders?.[0]?.name||"No workspace";return`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline'; script-src 'nonce-${t}'; connect-src http://localhost:* ws://localhost:*; frame-src http://localhost:*;">
    <title>Project Memory Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { 
            font-family: var(--vscode-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif); 
            background: var(--vscode-editor-background, #1e1e1e);
            color: var(--vscode-editor-foreground, #cccccc);
            min-height: 100%;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        .header {
            padding: 12px 16px;
            border-bottom: 1px solid var(--vscode-panel-border);
            display: flex;
            align-items: center;
            gap: 8px;
            position: sticky;
            top: 0;
            background: var(--vscode-editor-background);
            z-index: 10;
        }
        .header h2 { font-size: 14px; font-weight: 600; }
        .status { 
            display: flex; 
            align-items: center; 
            gap: 6px;
            margin-left: auto;
            font-size: 12px;
        }
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--vscode-testing-iconPassed);
        }
        .status-dot.error { background: var(--vscode-testing-iconFailed); }
        .status-dot.loading { background: var(--vscode-testing-iconQueued); animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            padding-bottom: 20px;
        }
        .fallback {
            padding: 20px;
            text-align: center;
        }
        .fallback p { margin-bottom: 12px; color: var(--vscode-descriptionForeground); }
        .btn {
            background: var(--vscode-button-background);
            color: var(--vscode-button-foreground);
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            margin: 4px;
        }
        .btn:hover { background: var(--vscode-button-hoverBackground); }
        .btn-secondary {
            background: var(--vscode-button-secondaryBackground);
            color: var(--vscode-button-secondaryForeground);
        }
        .btn-small {
            padding: 4px 8px;
            font-size: 11px;
            margin: 2px;
        }
        
        /* Toast notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--vscode-editor-background);
            border: 1px solid var(--vscode-panel-border);
            border-radius: 6px;
            padding: 10px 16px;
            font-size: 12px;
            z-index: 1000;
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        .toast-success {
            border-color: var(--vscode-testing-iconPassed);
            color: var(--vscode-testing-iconPassed);
        }
        .toast-error {
            border-color: var(--vscode-testing-iconFailed);
            color: var(--vscode-testing-iconFailed);
        }
        
        .info-card {
            background: var(--vscode-editor-inactiveSelectionBackground);
            border-radius: 6px;
            padding: 16px;
            margin: 12px 16px;
        }
        .info-card h3 { font-size: 13px; margin-bottom: 8px; }
        .info-card ul { list-style: none; font-size: 12px; }
        .info-card li { padding: 4px 0; display: flex; gap: 8px; }
        .info-card .label { color: var(--vscode-descriptionForeground); min-width: 80px; }
        
        /* Collapsible sections */
        .collapsible {
            background: var(--vscode-editor-inactiveSelectionBackground);
            border-radius: 6px;
            margin: 8px 16px;
            overflow: hidden;
        }
        .collapsible-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            user-select: none;
            gap: 8px;
        }
        .collapsible-header:hover {
            background: var(--vscode-list-hoverBackground);
        }
        .collapsible-header h3 { font-size: 13px; flex: 1; }
        .collapsible-header .count {
            background: var(--vscode-badge-background);
            color: var(--vscode-badge-foreground);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
        }
        .collapsible-header .chevron {
            transition: transform 0.2s;
        }
        .collapsible.collapsed .chevron { transform: rotate(-90deg); }
        .collapsible-content {
            max-height: 300px;
            overflow-y: auto;
            border-top: 1px solid var(--vscode-panel-border);
        }
        .collapsible.collapsed .collapsible-content { display: none; }
        
        /* Plan items */
        .plan-item {
            display: flex;
            align-items: center;
            padding: 10px 16px;
            gap: 10px;
            border-bottom: 1px solid var(--vscode-panel-border);
        }
        .plan-item:last-child { border-bottom: none; }
        .plan-item:hover { background: var(--vscode-list-hoverBackground); }
        .plan-info { flex: 1; min-width: 0; }
        .plan-title { 
            font-size: 12px; 
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .plan-meta {
            font-size: 10px;
            color: var(--vscode-descriptionForeground);
            display: flex;
            gap: 8px;
            margin-top: 2px;
        }
        .plan-status {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            text-transform: uppercase;
        }
        .plan-status.active { background: var(--vscode-testing-iconPassed); color: white; }
        .plan-status.archived { background: var(--vscode-descriptionForeground); color: white; }
        .plan-actions { display: flex; gap: 4px; }
        
        .empty-state {
            padding: 20px;
            text-align: center;
            color: var(--vscode-descriptionForeground);
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h2>\u{1F9E0} Project Memory</h2>
        <div class="status">
            <span class="status-dot loading" id="statusDot"></span>
            <span id="statusText">Checking...</span>
        </div>
    </div>
    <div class="content" id="content">
        <div class="fallback" id="fallback">
            <p>Connecting to dashboard server...</p>
        </div>
    </div>
    
    <script nonce="${t}">
        const vscode = acquireVsCodeApi();
        const apiPort = ${o};
        const dashboardUrl = '${i}';
        const workspaceId = '${n}';
        const workspaceName = '${a}';
        
        let activePlans = [];
        let archivedPlans = [];
        
        // Listen for messages from the extension
        window.addEventListener('message', function(event) {
            const message = event.data;
            if (message.type === 'deploymentComplete') {
                const { type, count, targetDir } = message.data;
                showToast('\u2705 Deployed ' + count + ' ' + type + ' to workspace', 'success');
            } else if (message.type === 'deploymentError') {
                showToast('\u274C ' + message.data.error, 'error');
            }
        });
        
        // Toast notification system
        function showToast(message, type) {
            // Remove existing toasts
            const existingToast = document.querySelector('.toast');
            if (existingToast) existingToast.remove();
            
            const toast = document.createElement('div');
            toast.className = 'toast toast-' + type;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => toast.classList.add('show'), 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // Use event delegation for button clicks (CSP-compliant)
        document.addEventListener('click', function(e) {
            const target = e.target;
            
            // Handle collapsible headers
            if (target.closest('.collapsible-header')) {
                const collapsible = target.closest('.collapsible');
                collapsible.classList.toggle('collapsed');
                return;
            }
            
            if (!target.matches('button')) return;
            
            const action = target.getAttribute('data-action');
            const command = target.getAttribute('data-command');
            const planId = target.getAttribute('data-plan-id');
            const copyText = target.getAttribute('data-copy');
            
            if (action === 'open-browser') {
                vscode.postMessage({ type: 'openExternal', data: { url: dashboardUrl } });
            } else if (action === 'refresh') {
                const statusDot = document.getElementById('statusDot');
                statusDot.className = 'status-dot loading';
                checkServer();
            } else if (action === 'run-command' && command) {
                vscode.postMessage({ type: 'runCommand', data: { command: command } });
            } else if (action === 'open-plan' && planId) {
                vscode.postMessage({ type: 'openPlan', data: { planId: planId, workspaceId: workspaceId } });
            } else if (action === 'copy' && copyText) {
                vscode.postMessage({ type: 'copyToClipboard', data: { text: copyText } });
            }
        });
        
        function renderPlanList(plans, type) {
            if (plans.length === 0) {
                return '<div class="empty-state">No ' + type + ' plans</div>';
            }
            return plans.map(plan => {
                const shortId = plan.id.split('_').pop() || plan.id.substring(0, 8);
                return \`
                    <div class="plan-item">
                        <div class="plan-info">
                            <div class="plan-title" title="\${plan.title}">\${plan.title}</div>
                            <div class="plan-meta">
                                <span>\${plan.category || 'general'}</span>
                                <span>\u2022</span>
                                <span>\${plan.progress?.done || 0}/\${plan.progress?.total || 0} steps</span>
                            </div>
                        </div>
                        <span class="plan-status \${plan.status}">\${plan.status}</span>
                        <div class="plan-actions">
                            <button class="btn btn-small btn-secondary" data-action="copy" data-copy="\${plan.id}" title="Copy plan ID">\u{1F4CB}</button>
                            <button class="btn btn-small" data-action="open-plan" data-plan-id="\${plan.id}" title="Open plan">\u2192</button>
                        </div>
                    </div>
                \`;
            }).join('');
        }
        
        async function fetchPlans() {
            if (!workspaceId) {
                console.log('No workspaceId, skipping plan fetch');
                return;
            }
            console.log('Fetching plans for workspace:', workspaceId);
            try {
                const response = await fetch('http://localhost:' + apiPort + '/api/plans/workspace/' + workspaceId);
                console.log('Plans response status:', response.status);
                if (response.ok) {
                    const data = await response.json();
                    console.log('Plans data:', data);
                    activePlans = (data.plans || []).filter(p => p.status === 'active');
                    archivedPlans = (data.plans || []).filter(p => p.status === 'archived');
                    updatePlanLists();
                }
            } catch (error) {
                console.log('Failed to fetch plans:', error);
            }
        }
        
        function updatePlanLists() {
            const activeList = document.getElementById('activePlansList');
            const archivedList = document.getElementById('archivedPlansList');
            const activeCount = document.getElementById('activeCount');
            const archivedCount = document.getElementById('archivedCount');
            
            if (activeList) activeList.innerHTML = renderPlanList(activePlans, 'active');
            if (archivedList) archivedList.innerHTML = renderPlanList(archivedPlans, 'archived');
            if (activeCount) activeCount.textContent = activePlans.length;
            if (archivedCount) archivedCount.textContent = archivedPlans.length;
        }
        
        async function checkServer() {
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            const content = document.getElementById('content');
            const fallback = document.getElementById('fallback');
            
            try {
                const response = await fetch('http://localhost:' + apiPort + '/api/health');
                if (response.ok) {
                    const data = await response.json();
                    statusDot.className = 'status-dot';
                    statusText.textContent = 'Connected';
                    
                    // Show dashboard info with plan lists
                    fallback.innerHTML = \`
                        <div class="info-card">
                            <h3>\u{1F4CA} Server Status</h3>
                            <ul>
                                <li><span class="label">Status:</span> <span>\u2713 Running</span></li>
                                <li><span class="label">API Port:</span> <span>\${apiPort}</span></li>
                                <li><span class="label">Workspace:</span> <span>\${workspaceName}</span></li>
                            </ul>
                        </div>
                        <div style="padding: 8px 16px; display: flex; gap: 8px;">
                            <button class="btn" style="flex:1" data-action="open-browser">Open Full Dashboard</button>
                            <button class="btn btn-secondary" data-action="refresh">\u21BB</button>
                        </div>
                        <div class="info-card">
                            <h3>\u26A1 Quick Actions</h3>
                            <ul>
                                <li><button class="btn btn-secondary" style="width:100%" data-action="run-command" data-command="projectMemory.createPlan">Create New Plan</button></li>
                                <li><button class="btn btn-secondary" style="width:100%" data-action="run-command" data-command="projectMemory.deployAgents">Deploy Agents</button></li>
                                <li><button class="btn btn-secondary" style="width:100%" data-action="run-command" data-command="projectMemory.deployInstructions">Deploy Instructions</button></li>
                                <li><button class="btn btn-secondary" style="width:100%" data-action="run-command" data-command="projectMemory.deployPrompts">Deploy Prompts</button></li>
                            </ul>
                        </div>
                        
                        <div class="info-card">
                            <h3>\u2699\uFE0F Configuration</h3>
                            <ul>
                                <li><button class="btn btn-secondary" style="width:100%" data-action="run-command" data-command="projectMemory.openSettings">Configure Defaults</button></li>
                                <li><button class="btn btn-secondary" style="width:100%" data-action="run-command" data-command="projectMemory.deployDefaults">Deploy All Defaults</button></li>
                            </ul>
                        </div>
                        
                        <div class="collapsible" id="activePlansSection">
                            <div class="collapsible-header">
                                <span class="chevron">\u25BC</span>
                                <h3>\u{1F4CB} Active Plans</h3>
                                <span class="count" id="activeCount">0</span>
                            </div>
                            <div class="collapsible-content" id="activePlansList">
                                <div class="empty-state">Loading...</div>
                            </div>
                        </div>
                        
                        <div class="collapsible collapsed" id="archivedPlansSection">
                            <div class="collapsible-header">
                                <span class="chevron">\u25BC</span>
                                <h3>\u{1F4E6} Archived Plans</h3>
                                <span class="count" id="archivedCount">0</span>
                            </div>
                            <div class="collapsible-content" id="archivedPlansList">
                                <div class="empty-state">Loading...</div>
                            </div>
                        </div>
                    \`;
                    
                    // Fetch plans after rendering
                    fetchPlans();
                } else {
                    throw new Error('Server returned ' + response.status);
                }
            } catch (error) {
                statusDot.className = 'status-dot error';
                statusText.textContent = 'Disconnected';
                fallback.innerHTML = \`
                    <p>Dashboard server is not running</p>
                    <button class="btn" data-action="run-command" data-command="projectMemory.startServer">Start Server</button>
                    <button class="btn btn-secondary" data-action="refresh">Retry</button>
                    <div class="info-card" style="margin-top: 20px;">
                        <h3>\u{1F4A1} Troubleshooting</h3>
                        <ul>
                            <li>Check if port \${apiPort} is available</li>
                            <li>View server logs for errors</li>
                            <li>Try restarting the server</li>
                        </ul>
                        <button class="btn btn-secondary" style="margin-top: 12px" data-action="run-command" data-command="projectMemory.showServerLogs">Show Server Logs</button>
                    </div>
                \`;
            }
        }
        
        // Initial check
        checkServer();
        
        // Periodic check every 30 seconds (reduced from 10 for performance)
        setInterval(checkServer, 30000);
        
        // Signal ready
        vscode.postMessage({ type: 'ready' });
    </script>
</body>
</html>`}};function No(){let s="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<32;t++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}var Ae=z(require("vscode")),So=z(Rs()),Ne=z(require("path")),mt=class{watcher=null;agentsRoot;autoDeploy;constructor(e,t){this.agentsRoot=e,this.autoDeploy=t}start(){if(this.watcher)return;let e=Ne.join(this.agentsRoot,"*.agent.md");this.watcher=So.watch(e,{persistent:!0,ignoreInitial:!0}),this.watcher.on("change",async t=>{let r=Ne.basename(t,".agent.md");this.autoDeploy?Ae.window.showInformationMessage(`Deploying updated agent: ${r}`):await Ae.window.showInformationMessage(`Agent template updated: ${r}`,"Deploy to All Workspaces","Ignore")==="Deploy to All Workspaces"&&Ae.commands.executeCommand("projectMemory.deployAgents")}),this.watcher.on("add",t=>{let r=Ne.basename(t,".agent.md");Ae.window.showInformationMessage(`New agent template detected: ${r}`)}),console.log(`Agent watcher started for: ${e}`)}stop(){this.watcher&&(this.watcher.close(),this.watcher=null,console.log("Agent watcher stopped"))}setAutoDeploy(e){this.autoDeploy=e}};var _e=z(require("vscode")),Ao=z(Rs()),vt=z(require("path")),wt=class{watchers=new Map;config;onFileChange;constructor(e){this.config=e}start(){this.config.agentsRoot&&this.startWatcher("agent",this.config.agentsRoot,"*.agent.md"),this.config.promptsRoot&&this.startWatcher("prompt",this.config.promptsRoot,"*.prompt.md"),this.config.instructionsRoot&&this.startWatcher("instruction",this.config.instructionsRoot,"*.instructions.md")}startWatcher(e,t,r){if(this.watchers.has(e))return;let o=vt.join(t,r),i=Ao.watch(o,{persistent:!0,ignoreInitial:!0});i.on("change",async n=>{this.handleFileEvent(e,n,"change")}),i.on("add",n=>{this.handleFileEvent(e,n,"add")}),i.on("unlink",n=>{this.handleFileEvent(e,n,"unlink")}),this.watchers.set(e,i),console.log(`${e} watcher started for: ${o}`)}async handleFileEvent(e,t,r){let o=vt.basename(t),n={agent:"Agent template",prompt:"Prompt file",instruction:"Instruction file"}[e];if(this.onFileChange&&this.onFileChange(e,t,r),r==="unlink"){_e.window.showWarningMessage(`${n} deleted: ${o}`);return}if(r==="add"){_e.window.showInformationMessage(`New ${n.toLowerCase()} detected: ${o}`);return}this.config.autoDeploy?(_e.window.showInformationMessage(`Auto-deploying updated ${n.toLowerCase()}: ${o}`),this.triggerDeploy(e)):await _e.window.showInformationMessage(`${n} updated: ${o}`,"Deploy to All Workspaces","Ignore")==="Deploy to All Workspaces"&&this.triggerDeploy(e)}triggerDeploy(e){let t={agent:"projectMemory.deployAgents",prompt:"projectMemory.deployPrompts",instruction:"projectMemory.deployInstructions"};_e.commands.executeCommand(t[e])}stop(){for(let[e,t]of this.watchers)t.close(),console.log(`${e} watcher stopped`);this.watchers.clear()}updateConfig(e){this.stop(),this.config={...this.config,...e},this.start()}setAutoDeploy(e){this.config.autoDeploy=e}onFileChanged(e){this.onFileChange=e}getWatchedPaths(){let e=[];return this.config.agentsRoot&&e.push({type:"agent",path:this.config.agentsRoot}),this.config.promptsRoot&&e.push({type:"prompt",path:this.config.promptsRoot}),this.config.instructionsRoot&&e.push({type:"instruction",path:this.config.instructionsRoot}),e}};var _t=z(require("vscode")),yt=class{statusBarItem;currentAgent=null;currentPlan=null;constructor(){this.statusBarItem=_t.window.createStatusBarItem(_t.StatusBarAlignment.Left,100),this.statusBarItem.command="projectMemory.showDashboard",this.updateDisplay(),this.statusBarItem.show()}setCurrentAgent(e){this.currentAgent=e,this.updateDisplay()}setCurrentPlan(e){this.currentPlan=e,this.updateDisplay()}updateDisplay(){this.currentAgent&&this.currentPlan?(this.statusBarItem.text=`$(robot) ${this.currentAgent} \xB7 ${this.currentPlan}`,this.statusBarItem.tooltip=`Project Memory: ${this.currentAgent} working on "${this.currentPlan}"`):this.currentAgent?(this.statusBarItem.text=`$(robot) ${this.currentAgent}`,this.statusBarItem.tooltip=`Project Memory: ${this.currentAgent} active`):(this.statusBarItem.text="$(robot) Project Memory",this.statusBarItem.tooltip="Click to open Project Memory Dashboard")}showTemporaryMessage(e,t=3e3){let r=this.statusBarItem.text,o=this.statusBarItem.tooltip;this.statusBarItem.text=`$(sync~spin) ${e}`,this.statusBarItem.tooltip=e,setTimeout(()=>{this.statusBarItem.text=r,this.statusBarItem.tooltip=o},t)}setCopilotStatus(e){e.agents+e.prompts+e.instructions>0?(this.statusBarItem.text=`$(robot) PM (${e.agents}A/${e.prompts}P/${e.instructions}I)`,this.statusBarItem.tooltip=`Project Memory
Agents: ${e.agents}
Prompts: ${e.prompts}
Instructions: ${e.instructions}`):this.updateDisplay()}dispose(){this.statusBarItem.dispose()}};var X=z(require("vscode")),je=require("child_process"),pe=z(require("path")),xs=z(require("http")),bt=class{serverProcess=null;frontendProcess=null;outputChannel;statusBarItem;_isRunning=!1;_isFrontendRunning=!1;_isExternalServer=!1;_isExternalFrontend=!1;config;restartAttempts=0;maxRestartAttempts=3;_performanceStats={apiCalls:0,avgResponseTime:0,lastCheck:Date.now()};constructor(e){this.config=e,this.outputChannel=X.window.createOutputChannel("Project Memory Server"),this.statusBarItem=X.window.createStatusBarItem(X.StatusBarAlignment.Right,100),this.statusBarItem.command="projectMemory.toggleServer"}get isRunning(){return this._isRunning}get isFrontendRunning(){return this._isFrontendRunning}get isExternalServer(){return this._isExternalServer}get performanceStats(){return{...this._performanceStats}}async start(){if(this._isRunning)return this.log("Server is already running"),!0;let e=this.config.serverPort||3001;if(this.log(`Checking if server already exists on port ${e}...`),await this.checkHealth(e))return this.log("Found existing server - connecting without spawning new process"),this._isRunning=!0,this._isExternalServer=!0,this.restartAttempts=0,this.updateStatusBar("connected"),X.window.showInformationMessage("Connected to existing Project Memory server"),!0;let r=this.getServerDirectory();if(!r)return X.window.showErrorMessage("Could not find dashboard server directory"),!1;this.log(`Starting server from: ${r}`),this._isExternalServer=!1,this.updateStatusBar("starting");try{let o={...process.env,PORT:String(this.config.serverPort||3001),WS_PORT:String(this.config.wsPort||3002),MBS_DATA_ROOT:this.config.dataRoot,MBS_AGENTS_ROOT:this.config.agentsRoot,MBS_PROMPTS_ROOT:this.config.promptsRoot||"",MBS_INSTRUCTIONS_ROOT:this.config.instructionsRoot||""},i=pe.join(r,"dist","index.js"),n,a;return require("fs").existsSync(i)?(n="node",a=[i]):(n=process.platform==="win32"?"npx.cmd":"npx",a=["tsx","src/index.ts"]),this.serverProcess=(0,je.spawn)(n,a,{cwd:r,env:o,shell:!0,windowsHide:!0}),this.serverProcess.stdout?.on("data",u=>{this.log(u.toString().trim())}),this.serverProcess.stderr?.on("data",u=>{this.log(`[stderr] ${u.toString().trim()}`)}),this.serverProcess.on("error",u=>{this.log(`Server error: ${u.message}`),this._isRunning=!1,this.updateStatusBar("error")}),this.serverProcess.on("exit",(u,p)=>{this.log(`Server exited with code ${u}, signal ${p}`),this._isRunning=!1,this.serverProcess=null,u!==0&&this.restartAttempts<this.maxRestartAttempts?(this.restartAttempts++,this.log(`Attempting restart (${this.restartAttempts}/${this.maxRestartAttempts})...`),setTimeout(()=>this.start(),2e3)):this.updateStatusBar("stopped")}),await this.waitForServer(1e4)?(this._isRunning=!0,this.restartAttempts=0,this.updateStatusBar("running"),this.log("Server started successfully"),!0):(this.log("Server failed to start within timeout"),this.stop(),!1)}catch(o){return this.log(`Failed to start server: ${o}`),this.updateStatusBar("error"),!1}}async stop(){if(this._isExternalServer){this.log("Disconnecting from external server (not stopping it)"),this._isRunning=!1,this._isExternalServer=!1,this.updateStatusBar("stopped");return}if(this.serverProcess)return this.log("Stopping server..."),this.updateStatusBar("stopping"),new Promise(e=>{if(!this.serverProcess){e();return}let t=setTimeout(()=>{this.serverProcess&&(this.log("Force killing server..."),this.serverProcess.kill("SIGKILL")),e()},5e3);this.serverProcess.on("exit",()=>{clearTimeout(t),this._isRunning=!1,this.serverProcess=null,this.updateStatusBar("stopped"),this.log("Server stopped"),e()}),process.platform==="win32"?(0,je.spawn)("taskkill",["/pid",String(this.serverProcess.pid),"/f","/t"],{windowsHide:!0}):this.serverProcess.kill("SIGTERM")})}async restart(){return await this.stop(),this.start()}async startFrontend(){if(this._isFrontendRunning)return this.log("Frontend is already running"),!0;if(await this.checkPort(5173))return this.log("Found existing frontend on port 5173 - using it"),this._isFrontendRunning=!0,this._isExternalFrontend=!0,!0;let t=this.getDashboardDirectory();if(!t)return this.log("Could not find dashboard directory for frontend"),!1;this.log(`Starting frontend from: ${t}`);try{let r=process.platform==="win32"?"npm.cmd":"npm",o=["run","dev"];return this.frontendProcess=(0,je.spawn)(r,o,{cwd:t,shell:!0,windowsHide:!0,env:{...process.env,VITE_API_URL:`http://localhost:${this.config.serverPort||3001}`}}),this.frontendProcess.stdout?.on("data",n=>{this.log(`[frontend] ${n.toString().trim()}`)}),this.frontendProcess.stderr?.on("data",n=>{this.log(`[frontend] ${n.toString().trim()}`)}),this.frontendProcess.on("error",n=>{this.log(`Frontend error: ${n.message}`),this._isFrontendRunning=!1}),this.frontendProcess.on("exit",(n,a)=>{this.log(`Frontend exited with code ${n}, signal ${a}`),this._isFrontendRunning=!1,this.frontendProcess=null}),await this.waitForPort(5173,15e3)?(this._isFrontendRunning=!0,this.log("Frontend started successfully on port 5173"),!0):(this.log("Frontend failed to start within timeout"),!1)}catch(r){return this.log(`Failed to start frontend: ${r}`),!1}}async stopFrontend(){if(this._isExternalFrontend){this.log("Disconnecting from external frontend (not stopping it)"),this._isFrontendRunning=!1,this._isExternalFrontend=!1;return}if(this.frontendProcess)return this.log("Stopping frontend..."),new Promise(e=>{if(!this.frontendProcess){e();return}let t=setTimeout(()=>{this.frontendProcess&&(this.log("Force killing frontend..."),this.frontendProcess.kill("SIGKILL")),e()},5e3);this.frontendProcess.on("exit",()=>{clearTimeout(t),this._isFrontendRunning=!1,this.frontendProcess=null,this.log("Frontend stopped"),e()}),process.platform==="win32"?(0,je.spawn)("taskkill",["/pid",String(this.frontendProcess.pid),"/f","/t"],{windowsHide:!0}):this.frontendProcess.kill("SIGTERM")})}getDashboardDirectory(){let e=X.workspace.workspaceFolders?.[0]?.uri.fsPath,t=X.extensions.getExtension("project-memory.project-memory-dashboard")?.extensionPath;this.log(`Looking for dashboard - workspacePath: ${e}, extensionPath: ${t}`);let r=[e?pe.join(e,"dashboard"):null,t?pe.join(t,"dashboard"):null,t?pe.join(t,"..","dashboard"):null].filter(Boolean);this.log(`Checking dashboard paths: ${JSON.stringify(r)}`);let o=require("fs");for(let i of r){let n=pe.join(i,"package.json");if(this.log(`Checking: ${n} - exists: ${o.existsSync(n)}`),o.existsSync(n))return i}return null}async waitForPort(e,t){let r=Date.now();for(;Date.now()-r<t;){try{if(await this.checkPort(e))return!0}catch{}await new Promise(o=>setTimeout(o,500))}return!1}checkPort(e){return new Promise(t=>{let r=xs.get(`http://localhost:${e}`,o=>{t(o.statusCode!==void 0)});r.on("error",()=>t(!1)),r.setTimeout(1e3,()=>{r.destroy(),t(!1)})})}updateConfig(e){this.config={...this.config,...e},this._isRunning&&this.restart()}getServerDirectory(){let e=X.extensions.getExtension("project-memory.project-memory-dashboard")?.extensionPath;this.log(`Extension path: ${e||"not found"}`);let t=X.workspace.workspaceFolders?.[0]?.uri.fsPath;this.log(`Workspace path: ${t||"not found"}`);let r=[t?pe.join(t,"dashboard","server"):null,e?pe.join(e,"server"):null,e?pe.join(e,"..","dashboard","server"):null,"c:\\Users\\User\\Project_Memory_MCP\\Project-Memory-MCP\\dashboard\\server"].filter(Boolean);this.log(`Checking paths: ${JSON.stringify(r)}`);let o=require("fs");for(let i of r){let n=pe.join(i,"package.json");if(this.log(`Checking: ${n}`),o.existsSync(n))return this.log(`Found server at: ${i}`),i}return this.log("Server directory not found in any location"),null}async waitForServer(e){let t=this.config.serverPort||3001,r=Date.now();for(;Date.now()-r<e;){try{if(await this.checkHealth(t))return!0}catch{}await new Promise(o=>setTimeout(o,500))}return!1}checkHealth(e){return new Promise(t=>{let r=xs.get(`http://localhost:${e}/api/health`,o=>{t(o.statusCode===200)});r.on("error",()=>t(!1)),r.setTimeout(1e3,()=>{r.destroy(),t(!1)})})}updateStatusBar(e){let t={starting:"$(loading~spin)",running:"$(check)",connected:"$(plug)",stopping:"$(loading~spin)",stopped:"$(circle-slash)",error:"$(error)"},r={running:new X.ThemeColor("statusBarItem.prominentBackground"),connected:new X.ThemeColor("statusBarItem.prominentBackground"),error:new X.ThemeColor("statusBarItem.errorBackground")},o={starting:"PM Server",running:"PM Server (local)",connected:"PM Server (shared)",stopping:"PM Server",stopped:"PM Server",error:"PM Server"};this.statusBarItem.text=`${t[e]} ${o[e]||"PM Server"}`,this.statusBarItem.tooltip=`Project Memory Server: ${e}${this._isExternalServer?" (connected to existing)":""}
Click to toggle`,this.statusBarItem.backgroundColor=r[e],this.statusBarItem.show()}async measureApiCall(e){let t=Date.now();try{let r=await e(),o=Date.now()-t;return this._performanceStats.apiCalls++,this._performanceStats.avgResponseTime=(this._performanceStats.avgResponseTime*(this._performanceStats.apiCalls-1)+o)/this._performanceStats.apiCalls,this._performanceStats.lastCheck=Date.now(),r}catch(r){throw r}}log(e){let t=new Date().toISOString();this.outputChannel.appendLine(`[${t}] ${e}`)}showLogs(){this.outputChannel.show()}dispose(){this.stop(),this.stopFrontend(),this.outputChannel.dispose(),this.statusBarItem.dispose()}};var Co=z(require("vscode")),K=z(require("fs")),Z=z(require("path")),Et=class{outputChannel;config;constructor(e){this.config=e,this.outputChannel=Co.window.createOutputChannel("Project Memory Deployment")}updateConfig(e){this.config={...this.config,...e}}async deployToWorkspace(e){let t=[],r=[];this.log(`Deploying defaults to workspace: ${e}`);let o=Z.join(e,".github","agents");for(let n of this.config.defaultAgents)try{await this.deployAgent(n,o)&&t.push(n)}catch(a){this.log(`Failed to deploy agent ${n}: ${a}`)}let i=Z.join(e,".github","instructions");for(let n of this.config.defaultInstructions)try{await this.deployInstruction(n,i)&&r.push(n)}catch(a){this.log(`Failed to deploy instruction ${n}: ${a}`)}return this.log(`Deployed ${t.length} agents, ${r.length} instructions`),{agents:t,instructions:r}}async deployAgent(e,t){let r=Z.join(this.config.agentsRoot,`${e}.agent.md`),o=Z.join(t,`${e}.agent.md`);return this.copyFile(r,o)}async deployInstruction(e,t){let r=Z.join(this.config.instructionsRoot,`${e}.instructions.md`),o=Z.join(t,`${e}.instructions.md`);return this.copyFile(r,o)}async updateWorkspace(e){let t=[],r=[],o=Z.join(e,".github","agents"),i=Z.join(e,".github","instructions");for(let n of this.config.defaultAgents){let a=Z.join(this.config.agentsRoot,`${n}.agent.md`),c=Z.join(o,`${n}.agent.md`);if(K.existsSync(a))if(K.existsSync(c)){let h=K.statSync(a),u=K.statSync(c);h.mtimeMs>u.mtimeMs&&(await this.copyFile(a,c,!0),t.push(n))}else await this.copyFile(a,c),r.push(n)}for(let n of this.config.defaultInstructions){let a=Z.join(this.config.instructionsRoot,`${n}.instructions.md`),c=Z.join(i,`${n}.instructions.md`);if(K.existsSync(a))if(K.existsSync(c)){let h=K.statSync(a),u=K.statSync(c);h.mtimeMs>u.mtimeMs&&(await this.copyFile(a,c,!0),t.push(n))}else await this.copyFile(a,c),r.push(n)}return{updated:t,added:r}}getDeploymentPlan(){let e=this.config.defaultAgents.filter(r=>{let o=Z.join(this.config.agentsRoot,`${r}.agent.md`);return K.existsSync(o)}),t=this.config.defaultInstructions.filter(r=>{let o=Z.join(this.config.instructionsRoot,`${r}.instructions.md`);return K.existsSync(o)});return{agents:e,instructions:t}}async copyFile(e,t,r=!1){if(!K.existsSync(e))return this.log(`Source not found: ${e}`),!1;if(K.existsSync(t)&&!r)return this.log(`Target exists, skipping: ${t}`),!1;let o=Z.dirname(t);return K.existsSync(o)||K.mkdirSync(o,{recursive:!0}),K.copyFileSync(e,t),this.log(`Copied: ${e} -> ${t}`),!0}log(e){let t=new Date().toISOString();this.outputChannel.appendLine(`[${t}] ${e}`)}showLogs(){this.outputChannel.show()}dispose(){this.outputChannel.dispose()}};var ie=z(require("vscode")),Rt=class s{static currentPanel;_panel;_disposables=[];static viewType="projectMemory.dashboard";constructor(e,t,r){this._panel=e,this._update(r),this._panel.onDidDispose(()=>this.dispose(),null,this._disposables),this._panel.webview.onDidReceiveMessage(o=>{o.type==="alert"&&ie.window.showInformationMessage(o.text)},null,this._disposables)}static createOrShow(e,t){let r=ie.window.activeTextEditor?ie.window.activeTextEditor.viewColumn:void 0;if(s.currentPanel){s.currentPanel._panel.reveal(r),s.currentPanel._update(t);return}let o=ie.window.createWebviewPanel(s.viewType,"\u{1F9E0} PMD",r||ie.ViewColumn.One,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[e]});s.currentPanel=new s(o,e,t)}static revive(e,t,r){s.currentPanel=new s(e,t,r)}_update(e){let t=this._panel.webview;this._panel.title="\u{1F9E0} PMD",this._panel.iconPath={light:ie.Uri.joinPath(ie.Uri.file(__dirname),"..","resources","icon.svg"),dark:ie.Uri.joinPath(ie.Uri.file(__dirname),"..","resources","icon.svg")},t.html=this._getHtmlForWebview(t,e)}_getHtmlForWebview(e,t){let r=Qa();return`<!DOCTYPE html>
<html lang="en" style="height: 100%; margin: 0; padding: 0;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; frame-src ${t} http://localhost:*; style-src 'unsafe-inline';">
    <title>Project Memory Dashboard</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-family: var(--vscode-font-family);
            color: var(--vscode-foreground);
            background: var(--vscode-editor-background);
        }
        .error {
            text-align: center;
            padding: 20px;
        }
        .error h2 {
            color: var(--vscode-errorForeground);
        }
        .error button {
            margin-top: 16px;
            padding: 8px 16px;
            background: var(--vscode-button-background);
            color: var(--vscode-button-foreground);
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .error button:hover {
            background: var(--vscode-button-hoverBackground);
        }
    </style>
</head>
<body>
    <iframe 
        id="dashboard-frame"
        src="${t}"
        title="Project Memory Dashboard"
        sandbox="allow-scripts allow-same-origin allow-forms allow-popups"
    ></iframe>
    
    <script nonce="${r}">
        (function() {
            const iframe = document.getElementById('dashboard-frame');
            if (iframe) {
                iframe.onerror = function() {
                    document.body.innerHTML = \`
                        <div class="error">
                            <h2>Unable to load dashboard</h2>
                            <p>Make sure the dashboard server is running on ${t}</p>
                            <button onclick="location.reload()">Retry</button>
                        </div>
                    \`;
                };
            }
        })();
    </script>
</body>
</html>`}dispose(){for(s.currentPanel=void 0,this._panel.dispose();this._disposables.length;){let e=this._disposables.pop();e&&e.dispose()}}};function Qa(){let s="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<32;t++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}var ae,We,Ce,Ss,O,Be;function Xa(s){console.log("Project Memory Dashboard extension activating...");let e=d.workspace.getConfiguration("projectMemory"),t=e.get("dataRoot")||Po(),r=e.get("agentsRoot")||xt(),o=e.get("promptsRoot"),i=e.get("instructionsRoot"),n=e.get("serverPort")||3001,a=e.get("wsPort")||3002,c=e.get("autoStartServer")??!0,h=e.get("defaultAgents")||[],u=e.get("defaultInstructions")||[],p=e.get("autoDeployOnWorkspaceOpen")??!1;if(Be=new Et({agentsRoot:r,instructionsRoot:i||ko(),defaultAgents:h,defaultInstructions:u}),p&&d.workspace.workspaceFolders?.[0]){let l=d.workspace.workspaceFolders[0].uri.fsPath;Be.deployToWorkspace(l).then(f=>{(f.agents.length>0||f.instructions.length>0)&&d.window.showInformationMessage(`Deployed ${f.agents.length} agents and ${f.instructions.length} instructions`)})}O=new bt({dataRoot:t,agentsRoot:r,promptsRoot:o,instructionsRoot:i,serverPort:n,wsPort:a}),s.subscriptions.push(O),c&&O.start().then(async l=>{l?O.isExternalServer?d.window.showInformationMessage("Connected to existing Project Memory server"):d.window.showInformationMessage("Project Memory API server started"):d.window.showWarningMessage("Failed to start Project Memory server. Click to view logs.","View Logs").then(f=>{f==="View Logs"&&O.showLogs()})}),ae=new Ve(s.extensionUri,t,r),s.subscriptions.push(d.window.registerWebviewViewProvider("projectMemory.dashboardView",ae,{webviewOptions:{retainContextWhenHidden:!0}})),s.subscriptions.push(d.commands.registerCommand("projectMemory.showDashboard",()=>{d.commands.executeCommand("workbench.view.extension.projectMemory")}),d.commands.registerCommand("projectMemory.openDashboardPanel",async l=>{if(!O.isRunning){if(await d.window.showWarningMessage("Project Memory server is not running. Start it first?","Start Server","Cancel")!=="Start Server")return;if(!await d.window.withProgress({location:d.ProgressLocation.Notification,title:"Starting Project Memory server...",cancellable:!1},async()=>await O.start())){d.window.showErrorMessage("Failed to start server. Check logs for details."),O.showLogs();return}}if(!O.isFrontendRunning&&!await d.window.withProgress({location:d.ProgressLocation.Notification,title:"Starting dashboard frontend...",cancellable:!1},async()=>await O.startFrontend())){d.window.showErrorMessage("Failed to start dashboard frontend. Check server logs."),O.showLogs();return}let f=l||"http://localhost:5173";Rt.createOrShow(s.extensionUri,f)}),d.commands.registerCommand("projectMemory.toggleServer",async()=>{O.isRunning?(await O.stopFrontend(),await O.stop(),d.window.showInformationMessage("Project Memory server stopped")):await O.start()?d.window.showInformationMessage("Project Memory server started"):d.window.showErrorMessage("Failed to start Project Memory server")}),d.commands.registerCommand("projectMemory.startServer",async()=>{if(O.isRunning){d.window.showInformationMessage("Server is already running");return}await O.start()?d.window.showInformationMessage("Project Memory server started"):(d.window.showErrorMessage("Failed to start server. Check logs for details."),O.showLogs())}),d.commands.registerCommand("projectMemory.stopServer",async()=>{await O.stopFrontend(),await O.stop(),d.window.showInformationMessage("Project Memory server stopped")}),d.commands.registerCommand("projectMemory.restartServer",async()=>{d.window.showInformationMessage("Restarting Project Memory server..."),await O.stopFrontend(),await O.restart()?d.window.showInformationMessage("Project Memory server restarted"):d.window.showErrorMessage("Failed to restart server")}),d.commands.registerCommand("projectMemory.showServerLogs",()=>{O.showLogs()}),d.commands.registerCommand("projectMemory.openSettings",()=>{d.commands.executeCommand("workbench.action.openSettings","@ext:project-memory.project-memory-dashboard")}),d.commands.registerCommand("projectMemory.createPlan",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}let f=await d.window.showQuickPick([{label:"\u{1F9E0} Brainstorm First",description:"Explore ideas with an AI agent before creating a formal plan",value:"brainstorm"},{label:"\u{1F4DD} Create Plan Directly",description:"Create a formal plan with title, description, and category",value:"create"}],{placeHolder:"How would you like to start?"});if(!f)return;if(f.value==="brainstorm"){let P=await d.window.showInputBox({prompt:"What would you like to brainstorm?",placeHolder:"Describe the feature, problem, or idea you want to explore...",validateInput:D=>D.trim()?null:"Please enter a description"});if(!P)return;try{await d.commands.executeCommand("workbench.action.chat.open",{query:`@brainstorm ${P}`})}catch{await d.window.showInformationMessage("Open GitHub Copilot Chat and use @brainstorm agent with your prompt.","Copy Prompt")==="Copy Prompt"&&(await d.env.clipboard.writeText(`@brainstorm ${P}`),d.window.showInformationMessage("Prompt copied to clipboard"))}return}let w=await d.window.showInputBox({prompt:"Enter plan title",placeHolder:"My new feature...",validateInput:P=>P.trim()?null:"Title is required"});if(!w)return;let y=await d.window.showInputBox({prompt:"Enter plan description",placeHolder:"Describe what this plan will accomplish, the goals, and any context...",validateInput:P=>P.trim().length>=10?null:"Please provide at least a brief description (10+ characters)"});if(!y)return;let E=await d.window.showQuickPick([{label:"\u2728 Feature",description:"New functionality or capability",value:"feature"},{label:"\u{1F41B} Bug",description:"Fix for an existing issue",value:"bug"},{label:"\u{1F504} Change",description:"Modification to existing behavior",value:"change"},{label:"\u{1F50D} Analysis",description:"Investigation or research task",value:"analysis"},{label:"\u{1F41E} Debug",description:"Debugging session for an issue",value:"debug"},{label:"\u267B\uFE0F Refactor",description:"Code improvement without behavior change",value:"refactor"},{label:"\u{1F4DA} Documentation",description:"Documentation updates",value:"documentation"}],{placeHolder:"Select plan category"});if(!E)return;let A=await d.window.showQuickPick([{label:"\u{1F534} Critical",description:"Urgent - needs immediate attention",value:"critical"},{label:"\u{1F7E0} High",description:"Important - should be done soon",value:"high"},{label:"\u{1F7E1} Medium",description:"Normal priority",value:"medium"},{label:"\u{1F7E2} Low",description:"Nice to have - when time permits",value:"low"}],{placeHolder:"Select priority level"});if(!A)return;let C=l[0].uri.fsPath,x=require("path").basename(C).toLowerCase().replace(/[^a-z0-9]/g,"_").substring(0,20),M=require("crypto").createHash("md5").update(C).digest("hex").substring(0,12),I=`${x}-${M}`;try{let P=await fetch(`http://localhost:${n}/api/plans`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workspaceId:I,title:w,description:y,category:E.value,priority:A.value})});if(P.ok){let D=await P.json();d.window.showInformationMessage(`Plan created: ${w}`,"Open Dashboard").then(S=>{S==="Open Dashboard"&&d.commands.executeCommand("projectMemory.openDashboardPanel",`http://localhost:5173/workspace/${I}/plan/${D.planId}`)})}else{let D=await P.text();d.window.showErrorMessage(`Failed to create plan: ${D}`)}}catch(P){d.window.showErrorMessage(`Failed to create plan: ${P}`)}}),d.commands.registerCommand("projectMemory.deployAgents",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}let f=d.workspace.getConfiguration("projectMemory"),w=f.get("agentsRoot")||xt(),y=f.get("defaultAgents")||[];if(!w){d.window.showErrorMessage("Agents root not configured. Set projectMemory.agentsRoot in settings.");return}let E=l[0].uri.fsPath,A=require("fs"),C=require("path");try{let x=A.readdirSync(w).filter(P=>P.endsWith(".agent.md"));if(y.length>0&&(x=x.filter(P=>{let D=P.replace(".agent.md","");return y.includes(D)})),x.length===0){d.window.showWarningMessage("No agent files found matching your defaults");return}let M=C.join(E,".github","agents");A.mkdirSync(M,{recursive:!0});let I=0;for(let P of x){let D=C.join(w,P),S=C.join(M,P);A.copyFileSync(D,S),I++}ae.postMessage({type:"deploymentComplete",data:{type:"agents",count:I,targetDir:M}}),d.window.showInformationMessage(`\u2705 Deployed ${I} agent(s) to ${C.relative(E,M)}`,"Open Folder").then(P=>{P==="Open Folder"&&d.commands.executeCommand("revealInExplorer",d.Uri.file(M))})}catch(x){d.window.showErrorMessage(`Failed to deploy agents: ${x}`)}}),d.commands.registerCommand("projectMemory.deployPrompts",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}let w=d.workspace.getConfiguration("projectMemory").get("promptsRoot")||Ja();if(!w){d.window.showErrorMessage("Prompts root not configured. Set projectMemory.promptsRoot in settings.");return}let y=l[0].uri.fsPath,E=require("fs"),A=require("path");try{let C=E.readdirSync(w).filter(I=>I.endsWith(".prompt.md"));if(C.length===0){d.window.showWarningMessage("No prompt files found in prompts root");return}let x=A.join(y,".github","prompts");E.mkdirSync(x,{recursive:!0});let M=0;for(let I of C){let P=A.join(w,I),D=A.join(x,I);E.copyFileSync(P,D),M++}ae.postMessage({type:"deploymentComplete",data:{type:"prompts",count:M,targetDir:x}}),d.window.showInformationMessage(`\u2705 Deployed ${M} prompt(s) to ${A.relative(y,x)}`,"Open Folder").then(I=>{I==="Open Folder"&&d.commands.executeCommand("revealInExplorer",d.Uri.file(x))})}catch(C){d.window.showErrorMessage(`Failed to deploy prompts: ${C}`)}}),d.commands.registerCommand("projectMemory.deployInstructions",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}let f=d.workspace.getConfiguration("projectMemory"),w=f.get("instructionsRoot")||ko(),y=f.get("defaultInstructions")||[];if(!w){d.window.showErrorMessage("Instructions root not configured. Set projectMemory.instructionsRoot in settings.");return}let E=l[0].uri.fsPath,A=require("fs"),C=require("path");try{let x=A.readdirSync(w).filter(P=>P.endsWith(".instructions.md"));if(y.length>0&&(x=x.filter(P=>{let D=P.replace(".instructions.md","");return y.includes(D)})),x.length===0){d.window.showWarningMessage("No instruction files found matching your defaults");return}let M=C.join(E,".github","instructions");A.mkdirSync(M,{recursive:!0});let I=0;for(let P of x){let D=C.join(w,P),S=C.join(M,P);A.copyFileSync(D,S),I++}ae.postMessage({type:"deploymentComplete",data:{type:"instructions",count:I,targetDir:M}}),d.window.showInformationMessage(`\u2705 Deployed ${I} instruction(s) to ${C.relative(E,M)}`,"Open Folder").then(P=>{P==="Open Folder"&&d.commands.executeCommand("revealInExplorer",d.Uri.file(M))})}catch(x){d.window.showErrorMessage(`Failed to deploy instructions: ${x}`)}}),d.commands.registerCommand("projectMemory.deployCopilotConfig",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}await d.window.showQuickPick(["Yes","No"],{placeHolder:"Deploy all Copilot config (agents, prompts, instructions)?"})==="Yes"&&(ae.postMessage({type:"deployAllCopilotConfig",data:{workspacePath:l[0].uri.fsPath}}),d.window.showInformationMessage("Deploying all Copilot configuration..."))}),d.commands.registerCommand("projectMemory.deployDefaults",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}let f=Be.getDeploymentPlan();if(await d.window.showQuickPick(["Yes","No"],{placeHolder:`Deploy ${f.agents.length} agents and ${f.instructions.length} instructions?`})==="Yes"){let y=await Be.deployToWorkspace(l[0].uri.fsPath);d.window.showInformationMessage(`Deployed ${y.agents.length} agents and ${y.instructions.length} instructions`)}}),d.commands.registerCommand("projectMemory.updateDefaults",async()=>{let l=d.workspace.workspaceFolders;if(!l){d.window.showErrorMessage("No workspace folder open");return}let f=await Be.updateWorkspace(l[0].uri.fsPath);f.updated.length>0||f.added.length>0?d.window.showInformationMessage(`Updated ${f.updated.length} files, added ${f.added.length} new files`):d.window.showInformationMessage("All files are up to date")}),d.commands.registerCommand("projectMemory.openAgentFile",async()=>{let f=d.workspace.getConfiguration("projectMemory").get("agentsRoot")||xt();if(!f){d.window.showErrorMessage("Agents root not configured");return}let w=require("fs"),y=require("path");try{let E=w.readdirSync(f).filter(C=>C.endsWith(".agent.md")),A=await d.window.showQuickPick(E,{placeHolder:"Select an agent file to open"});if(A){let C=y.join(f,A),x=await d.workspace.openTextDocument(C);await d.window.showTextDocument(x)}}catch(E){d.window.showErrorMessage(`Failed to list agent files: ${E}`)}}),d.commands.registerCommand("projectMemory.openPromptFile",async()=>{let f=d.workspace.getConfiguration("projectMemory").get("promptsRoot");if(!f){d.window.showErrorMessage("Prompts root not configured. Set projectMemory.promptsRoot in settings.");return}let w=require("fs"),y=require("path");try{let E=w.readdirSync(f).filter(C=>C.endsWith(".prompt.md")),A=await d.window.showQuickPick(E,{placeHolder:"Select a prompt file to open"});if(A){let C=y.join(f,A),x=await d.workspace.openTextDocument(C);await d.window.showTextDocument(x)}}catch(E){d.window.showErrorMessage(`Failed to list prompt files: ${E}`)}}),d.commands.registerCommand("projectMemory.showCopilotStatus",()=>{ae.postMessage({type:"showCopilotStatus"}),d.commands.executeCommand("workbench.view.extension.projectMemory")}),d.commands.registerCommand("projectMemory.refreshData",()=>{ae.postMessage({type:"refresh"})}),d.commands.registerCommand("projectMemory.openFile",async(l,f)=>{try{let w=await d.workspace.openTextDocument(l),y=await d.window.showTextDocument(w);if(f!==void 0){let E=new d.Position(f-1,0);y.selection=new d.Selection(E,E),y.revealRange(new d.Range(E,E),d.TextEditorRevealType.InCenter)}}catch{d.window.showErrorMessage(`Failed to open file: ${l}`)}}),d.commands.registerCommand("projectMemory.addToPlan",async l=>{let f,w,y;if(l)f=l.fsPath;else{let x=d.window.activeTextEditor;if(x){f=x.document.uri.fsPath;let M=x.selection;M.isEmpty||(w=x.document.getText(M),y=M.start.line+1)}}if(!f){d.window.showErrorMessage("No file selected");return}if(!d.workspace.workspaceFolders){d.window.showErrorMessage("No workspace folder open");return}let A=await d.window.showInputBox({prompt:"Describe the step/task for this file",placeHolder:"e.g., Review and update authentication logic",value:w?`Review: ${w.substring(0,50)}...`:`Work on ${require("path").basename(f)}`});if(!A)return;let C=await d.window.showQuickPick(["implementation","review","testing","documentation","refactor","bugfix"],{placeHolder:"Select the phase for this step"});C&&(ae.postMessage({type:"addStepToPlan",data:{task:A,phase:C,file:f,line:y,notes:w?`Selected code:
\`\`\`
${w.substring(0,500)}
\`\`\``:void 0}}),d.window.showInformationMessage(`Added step to plan: "${A}"`))})),r&&(We=new mt(r,e.get("autoDeployAgents")||!1),We.start(),s.subscriptions.push({dispose:()=>We.stop()})),Ce=new wt({agentsRoot:r,promptsRoot:o,instructionsRoot:i,autoDeploy:e.get("autoDeployAgents")||!1}),Ce.start(),Ce.onFileChanged((l,f,w)=>{w==="change"&&Ss.showTemporaryMessage(`${l} updated`)}),s.subscriptions.push({dispose:()=>Ce.stop()}),Ss=new yt,s.subscriptions.push(Ss),s.subscriptions.push(d.workspace.onDidChangeConfiguration(l=>{if(l.affectsConfiguration("projectMemory")){let f=d.workspace.getConfiguration("projectMemory");ae.updateConfig(f.get("dataRoot")||Po(),f.get("agentsRoot")||xt())}})),console.log("Project Memory Dashboard extension activated")}async function Za(){console.log("Project Memory Dashboard extension deactivating..."),ae&&ae.dispose(),We&&We.stop(),Ce&&Ce.stop(),O&&(await O.stopFrontend(),await O.stop()),console.log("Project Memory Dashboard extension deactivated")}function Po(){let s=d.workspace.workspaceFolders;return s?d.Uri.joinPath(s[0].uri,"data").fsPath:""}function xt(){let s=d.workspace.workspaceFolders;return s?d.Uri.joinPath(s[0].uri,"agents").fsPath:""}function ko(){let s=d.workspace.workspaceFolders;return s?d.Uri.joinPath(s[0].uri,"instructions").fsPath:""}function Ja(){let s=d.workspace.workspaceFolders;return s?d.Uri.joinPath(s[0].uri,"prompts").fsPath:""}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

normalize-path/index.js:
  (*!
   * normalize-path <https://github.com/jonschlinkert/normalize-path>
   *
   * Copyright (c) 2014-2018, Jon Schlinkert.
   * Released under the MIT License.
   *)

is-extglob/index.js:
  (*!
   * is-extglob <https://github.com/jonschlinkert/is-extglob>
   *
   * Copyright (c) 2014-2016, Jon Schlinkert.
   * Licensed under the MIT License.
   *)

is-glob/index.js:
  (*!
   * is-glob <https://github.com/jonschlinkert/is-glob>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   *)

is-number/index.js:
  (*!
   * is-number <https://github.com/jonschlinkert/is-number>
   *
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)

to-regex-range/index.js:
  (*!
   * to-regex-range <https://github.com/micromatch/to-regex-range>
   *
   * Copyright (c) 2015-present, Jon Schlinkert.
   * Released under the MIT License.
   *)

fill-range/index.js:
  (*!
   * fill-range <https://github.com/jonschlinkert/fill-range>
   *
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Licensed under the MIT License.
   *)
*/
