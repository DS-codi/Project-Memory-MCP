{
  "name": "project-memory-dashboard",
  "displayName": "Project Memory Dashboard",
  "description": "Visual dashboard for the Project Memory MCP server - track agent workflows, plans, and handoffs",
  "version": "0.2.0",
  "publisher": "project-memory",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/project-memory/project-memory-mcp"
  },
  "engines": {
    "vscode": "^1.99.0"
  },
  "categories": [
    "Other",
    "Visualization"
  ],
  "keywords": [
    "mcp",
    "model context protocol",
    "ai agents",
    "project management",
    "copilot"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "chatParticipants": [
      {
        "id": "project-memory.memory",
        "name": "memory",
        "description": "Access project plans, context, and agent workflows from Project Memory",
        "isSticky": true,
        "commands": [
          { "name": "plan", "description": "View, create, or manage plans" },
          { "name": "context", "description": "Get workspace context and codebase profile" },
          { "name": "handoff", "description": "Execute an agent handoff" },
          { "name": "status", "description": "Show current plan progress" }
        ]
      }
    ],
    "languageModelTools": [
      {
        "name": "memory_plan",
        "displayName": "Project Memory Plan",
        "description": "Manage project plans - list, get, create, or archive",
        "modelDescription": "Manage Project Memory plans. Actions: 'list' to see all plans, 'get' to retrieve a specific plan by planId, 'create' to start a new plan (requires title, description, category), 'archive' to archive a completed plan.",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": { 
              "type": "string", 
              "enum": ["list", "get", "create", "archive"], 
              "description": "The action to perform" 
            },
            "planId": { "type": "string", "description": "The plan ID (required for get/archive)" },
            "title": { "type": "string", "description": "Plan title (for create)" },
            "description": { "type": "string", "description": "Plan description (for create)" },
            "category": { 
              "type": "string", 
              "enum": ["feature", "bug", "change", "analysis", "debug", "refactor", "documentation"], 
              "description": "Plan category (for create)" 
            },
            "priority": { 
              "type": "string", 
              "enum": ["low", "medium", "high", "critical"], 
              "description": "Plan priority (for create)" 
            },
            "includeArchived": { "type": "boolean", "description": "Include archived plans (for list)" }
          },
          "required": ["action"]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_steps",
        "displayName": "Project Memory Steps",
        "description": "Manage plan steps - update status, batch update, or add new steps",
        "modelDescription": "Manage Project Memory plan steps. Actions: 'update' to change a single step status (requires planId, stepIndex, status), 'batch_update' to update multiple steps (requires planId, updates array), 'add' to append new steps (requires planId, newSteps array).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": { 
              "type": "string", 
              "enum": ["update", "batch_update", "add"], 
              "description": "The action to perform" 
            },
            "planId": { "type": "string", "description": "The plan ID" },
            "stepIndex": { "type": "number", "description": "Step index (for update action)" },
            "status": { 
              "type": "string", 
              "enum": ["pending", "active", "done", "blocked"], 
              "description": "New status (for update action)" 
            },
            "notes": { "type": "string", "description": "Notes to add (for update action)" },
            "updates": { 
              "type": "array", 
              "items": {
                "type": "object",
                "properties": {
                  "step_index": { "type": "number" },
                  "status": { "type": "string" },
                  "notes": { "type": "string" }
                }
              },
              "description": "Array of step updates (for batch_update action)" 
            },
            "newSteps": { 
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "phase": { "type": "string" },
                  "task": { "type": "string" },
                  "status": { "type": "string" }
                }
              },
              "description": "New steps to add (for add action)" 
            }
          },
          "required": ["action", "planId"]
        }
      },
      {
        "name": "memory_context",
        "displayName": "Project Memory Context",
        "description": "Manage context - add notes, get briefing, handoff, or workspace info",
        "modelDescription": "Manage Project Memory context. Actions: 'add_note' to add a note to a plan (requires planId, note), 'briefing' to get mission briefing for an agent (requires planId), 'handoff' to transfer to another agent (requires planId, targetAgent, reason), 'workspace' to get workspace info and codebase profile.",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": { 
              "type": "string", 
              "enum": ["add_note", "briefing", "handoff", "workspace"], 
              "description": "The action to perform" 
            },
            "planId": { "type": "string", "description": "The plan ID (required for add_note, briefing, handoff)" },
            "note": { "type": "string", "description": "Note content (for add_note action)" },
            "noteType": { 
              "type": "string", 
              "enum": ["info", "warning", "instruction"], 
              "description": "Note type (for add_note action)" 
            },
            "targetAgent": { 
              "type": "string", 
              "enum": ["Coordinator", "Researcher", "Architect", "Executor", "Reviewer", "Tester", "Archivist"],
              "description": "Target agent (for handoff action)" 
            },
            "reason": { "type": "string", "description": "Reason for handoff (for handoff action)" }
          },
          "required": ["action"]
        },
        "canBeInvokedManually": true
      }
    ],
    "commands": [
      {
        "command": "projectMemory.showDashboard",
        "title": "Show Dashboard",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openDashboardPanel",
        "title": "Open Full Dashboard (PMD Tab)",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.createPlan",
        "title": "Create New Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployAgents",
        "title": "Deploy Agents to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployPrompts",
        "title": "Deploy Prompts to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployInstructions",
        "title": "Deploy Instructions to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployCopilotConfig",
        "title": "Deploy All Copilot Config (Agents, Prompts, Instructions)",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployDefaults",
        "title": "Deploy Default Agents & Instructions",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.updateDefaults",
        "title": "Update Deployed Files from Source",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.refreshData",
        "title": "Refresh Dashboard",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.addToPlan",
        "title": "Add to Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openAgentFile",
        "title": "Open Agent File",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openPromptFile",
        "title": "Open Prompt File",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.showCopilotStatus",
        "title": "Show Copilot Status",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.toggleServer",
        "title": "Toggle Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.startServer",
        "title": "Start Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.stopServer",
        "title": "Stop Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.restartServer",
        "title": "Restart Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.showServerLogs",
        "title": "Show Server Logs",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openSettings",
        "title": "Open Settings",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.chat.reconnect",
        "title": "Reconnect Chat to MCP Server",
        "category": "Project Memory"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "projectMemory",
          "title": "Project Memory",
          "icon": "resources/sidebar-icon.svg"
        }
      ]
    },
    "views": {
      "projectMemory": [
        {
          "type": "webview",
          "id": "projectMemory.dashboardView",
          "name": "Dashboard"
        }
      ]
    },
    "configuration": {
      "title": "Project Memory",
      "properties": {
        "projectMemory.dataRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the Project Memory data directory (MBS_DATA_ROOT)",
          "scope": "application"
        },
        "projectMemory.agentsRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the agent templates directory (MBS_AGENTS_ROOT)",
          "scope": "application"
        },
        "projectMemory.autoRefresh": {
          "type": "boolean",
          "default": true,
          "description": "Automatically refresh dashboard when files change"
        },
        "projectMemory.autoDeployAgents": {
          "type": "boolean",
          "default": false,
          "description": "Automatically deploy agents when template files are saved"
        },
        "projectMemory.apiPort": {
          "type": "number",
          "default": 3001,
          "description": "Port for the dashboard API server"
        },
        "projectMemory.serverPort": {
          "type": "number",
          "default": 3001,
          "description": "Port for the dashboard API server (same as apiPort)"
        },
        "projectMemory.wsPort": {
          "type": "number",
          "default": 3002,
          "description": "Port for the WebSocket server (live updates)"
        },
        "projectMemory.autoStartServer": {
          "type": "boolean",
          "default": true,
          "description": "Automatically start the dashboard server when extension activates"
        },
        "projectMemory.promptsRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the prompt templates directory (MBS_PROMPTS_ROOT)",
          "scope": "application"
        },
        "projectMemory.instructionsRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the instruction files directory (MBS_INSTRUCTIONS_ROOT)",
          "scope": "application"
        },
        "projectMemory.defaultAgents": {
          "type": "array",
          "default": ["coordinator", "researcher", "architect", "executor", "reviewer", "tester", "archivist", "revisionist", "runner"],
          "description": "List of agent names to auto-deploy to new workspaces"
        },
        "projectMemory.defaultInstructions": {
          "type": "array",
          "default": ["project-memory-system", "mvc-architecture", "handoff-protocol"],
          "description": "List of instruction files to auto-deploy to new workspaces"
        },
        "projectMemory.defaultPrompts": {
          "type": "array",
          "default": ["new-feature", "fix-bug", "refactor", "document"],
          "description": "List of prompt files to pre-select when deploying prompts"
        },
        "projectMemory.autoDeployOnWorkspaceOpen": {
          "type": "boolean",
          "default": false,
          "description": "Automatically deploy default agents and instructions when opening a workspace"
        },
        "projectMemory.showNotifications": {
          "type": "boolean",
          "default": true,
          "description": "Show toast notifications for deployment and server events"
        },
        "projectMemory.chat.serverMode": {
          "type": "string",
          "enum": ["bundled", "podman", "external"],
          "default": "bundled",
          "description": "How to run the MCP server for chat integration",
          "enumDescriptions": [
            "Spawn bundled server automatically",
            "Run in Podman container",
            "Connect to external server"
          ]
        },
        "projectMemory.chat.podmanImage": {
          "type": "string",
          "default": "project-memory-mcp:latest",
          "description": "Podman/Docker image name for MCP server (when serverMode is 'podman')"
        },
        "projectMemory.chat.externalServerPath": {
          "type": "string",
          "default": "",
          "description": "Path to external MCP server executable (when serverMode is 'external')"
        },
        "projectMemory.chat.autoConnect": {
          "type": "boolean",
          "default": true,
          "description": "Automatically connect to MCP server when extension activates"
        }
      }
    },
    "menus": {
      "explorer/context": [
        {
          "command": "projectMemory.createPlan",
          "group": "projectMemory",
          "when": "explorerResourceIsFolder"
        },
        {
          "command": "projectMemory.addToPlan",
          "group": "projectMemory@2",
          "when": "!explorerResourceIsFolder"
        }
      ],
      "editor/context": [
        {
          "command": "projectMemory.addToPlan",
          "group": "projectMemory",
          "when": "editorHasSelection"
        }
      ]
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run esbuild-base -- --production",
    "esbuild-base": "node esbuild.js",
    "esbuild": "npm run esbuild-base -- --sourcemap",
    "esbuild-watch": "npm run esbuild-base -- --sourcemap --watch",
    "compile": "npm run esbuild",
    "watch": "npm run esbuild-watch",
    "pretest": "npm run esbuild",
    "test": "node ./out/test/runTest.js",
    "lint": "eslint src --ext ts",
    "package": "vsce package",
    "build-webview": "cd webview && npm run build"
  },
  "devDependencies": {
    "@types/mocha": "^10.0.10",
    "@types/node": "^20.10.0",
    "@types/vscode": "^1.99.0",
    "@typescript-eslint/eslint-plugin": "^8.54.0",
    "@typescript-eslint/parser": "^8.54.0",
    "@vscode/test-electron": "^2.5.2",
    "esbuild": "^0.27.2",
    "eslint": "^9.39.2",
    "mocha": "^11.3.0",
    "typescript": "^5.3.0"
  },
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.0.0",
    "chokidar": "^3.5.3",
    "glob": "^13.0.0"
  }
}
