{
  "name": "project-memory-dashboard",
  "displayName": "Project Memory Dashboard",
  "description": "Visual dashboard for the Project Memory MCP server - track agent workflows, plans, and handoffs",
  "version": "0.2.0",
  "publisher": "project-memory",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/project-memory/project-memory-mcp"
  },
  "engines": {
    "vscode": "^1.109.0"
  },
  "categories": [
    "Other",
    "Visualization"
  ],
  "keywords": [
    "mcp",
    "model context protocol",
    "ai agents",
    "project management",
    "copilot"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "chatParticipants": [
      {
        "id": "project-memory.memory",
        "name": "memory",
        "description": "Access project plans, context, and agent workflows from Project Memory",
        "isSticky": true,
        "commands": [
          {
            "name": "plan",
            "description": "View, create, or manage plans"
          },
          {
            "name": "context",
            "description": "Get workspace context and codebase profile"
          },
          {
            "name": "handoff",
            "description": "Execute an agent handoff"
          },
          {
            "name": "status",
            "description": "Show current plan progress"
          },
          {
            "name": "deploy",
            "description": "Deploy agents, skills, or instructions to a workspace"
          },
          {
            "name": "diagnostics",
            "description": "Run system diagnostics and show health report"
          },
          {
            "name": "knowledge",
            "description": "Manage workspace knowledge files (list, show, add, delete)"
          }
        ]
      }
    ],
    "languageModelTools": [
      {
        "name": "memory_workspace",
        "displayName": "Project Memory Workspace",
        "description": "Manage workspaces - register, list, get info, reindex, or link/unlink hierarchy",
        "modelDescription": "Manage Project Memory workspaces. Actions: 'register' to register a workspace (optional workspacePath), 'list' to list all workspaces (optional hierarchical=true for nested view), 'info' to get workspace details (optional workspaceId), 'reindex' to refresh the codebase profile (optional workspaceId), 'link' to link/unlink parent-child workspace hierarchy (requires workspaceId as parent, childWorkspaceId, optional mode='link'|'unlink').",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "register",
                "list",
                "info",
                "reindex",
                "link"
              ],
              "description": "The action to perform"
            },
            "workspacePath": {
              "type": "string",
              "description": "Workspace path (for register)"
            },
            "force": {
              "type": "boolean",
              "description": "Force registration even if directory overlaps with existing workspace (for register)"
            },
            "workspaceId": {
              "type": "string",
              "description": "Workspace ID (for info/reindex/link)"
            },
            "childWorkspaceId": {
              "type": "string",
              "description": "Child workspace ID (for link action)"
            },
            "mode": {
              "type": "string",
              "enum": ["link", "unlink"],
              "description": "Link or unlink mode (for link action, defaults to link)"
            },
            "hierarchical": {
              "type": "boolean",
              "description": "When true, group child workspaces under parents in list results (for list action)"
            }
          },
          "required": [
            "action"
          ]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_agent",
        "displayName": "Project Memory Agent",
        "description": "Agent lifecycle - init sessions, complete, handoff, validate, list agents, get instructions",
        "modelDescription": "Manage Project Memory agent lifecycle. Actions: 'init' to start an agent session (requires planId, agentType), 'complete' to finish a session (requires planId, agentType), 'handoff' to transfer to another agent (requires planId, toAgent), 'validate' to check agent validity (requires agentType), 'list' to list agent sessions, 'get_instructions' to get agent instruction file (requires agentType).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "init",
                "complete",
                "handoff",
                "validate",
                "list",
                "get_instructions",
                "deploy",
                "get_briefing",
                "get_lineage"
              ],
              "description": "The action to perform"
            },
            "planId": {
              "type": "string",
              "description": "Plan ID"
            },
            "agentType": {
              "type": "string",
              "description": "Agent type (e.g. Coordinator, Executor)"
            },
            "toAgent": {
              "type": "string",
              "description": "Target agent (for handoff)"
            },
            "fromAgent": {
              "type": "string",
              "description": "Source agent (for handoff)"
            },
            "reason": {
              "type": "string",
              "description": "Handoff reason"
            },
            "summary": {
              "type": "string",
              "description": "Session summary or handoff summary"
            },
            "taskDescription": {
              "type": "string",
              "description": "Task description (for init/validate)"
            },
            "workspace_path": {
              "type": "string",
              "description": "Workspace path (for deploy)"
            },
            "include_instructions": {
              "type": "boolean",
              "description": "Include instructions in deployment"
            },
            "include_skills": {
              "type": "boolean",
              "description": "Include skills in deployment"
            }
          },
          "required": [
            "action"
          ]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_plan",
        "displayName": "Project Memory Plan",
        "description": "Manage plans - list, get, create, archive, update, find, set goals, manage build scripts, add notes",
        "modelDescription": "Manage Project Memory plans. Actions: 'list' to see all plans, 'get' to retrieve a plan by planId, 'create' to start a new plan (requires title, description), 'archive' to archive a plan, 'update' to update plan steps, 'find' to find a plan by ID, 'set_goals' to set goals and success criteria, 'add_build_script' to add a build script (requires scriptName, scriptCommand), 'delete_build_script' to remove a build script (requires scriptId), 'add_note' to add a note (requires note).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "list",
                "get",
                "create",
                "archive",
                "update",
                "find",
                "set_goals",
                "add_build_script",
                "delete_build_script",
                "add_note",
                "create_program",
                "add_plan_to_program",
                "upgrade_to_program",
                "list_program_plans",
                "export_plan"
              ],
              "description": "The action to perform"
            },
            "planId": {
              "type": "string",
              "description": "Plan ID"
            },
            "title": {
              "type": "string",
              "description": "Plan title (for create)"
            },
            "description": {
              "type": "string",
              "description": "Plan description (for create)"
            },
            "category": {
              "type": "string",
              "enum": [
                "feature",
                "bug",
                "change",
                "analysis",
                "investigation",
                "debug",
                "refactor",
                "documentation"
              ],
              "description": "Plan category"
            },
            "priority": {
              "type": "string",
              "enum": [
                "low",
                "medium",
                "high",
                "critical"
              ],
              "description": "Plan priority"
            },
            "template": {
              "type": "string",
              "description": "Plan template (for create)"
            },
            "goals": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Plan goals"
            },
            "success_criteria": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Success criteria"
            },
            "includeArchived": {
              "type": "boolean",
              "description": "Include archived plans (for list)"
            },
            "note": {
              "type": "string",
              "description": "Note content (for add_note)"
            },
            "noteType": {
              "type": "string",
              "enum": [
                "info",
                "warning",
                "instruction"
              ],
              "description": "Note type"
            },
            "scriptName": {
              "type": "string",
              "description": "Build script name"
            },
            "scriptCommand": {
              "type": "string",
              "description": "Build script command"
            },
            "scriptDescription": {
              "type": "string",
              "description": "Build script description"
            },
            "scriptDirectory": {
              "type": "string",
              "description": "Build script working directory"
            },
            "scriptId": {
              "type": "string",
              "description": "Build script ID (for delete)"
            },
            "program_id": {
              "type": "string",
              "description": "Program ID (for program actions)"
            },
            "move_steps_to_child": {
              "type": "boolean",
              "description": "Move existing steps to a child plan when upgrading to program"
            },
            "child_plan_title": {
              "type": "string",
              "description": "Title for child plan when upgrading with move_steps_to_child"
            }
          },
          "required": [
            "action"
          ]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_steps",
        "displayName": "Project Memory Steps",
        "description": "Manage plan steps - update, batch update, add, insert, delete, reorder, move, replace",
        "modelDescription": "Manage Project Memory plan steps. Actions: 'update' to change a step status (requires planId, stepIndex, status), 'batch_update' to update multiple steps (requires planId, updates array), 'add' to append new steps (requires planId, newSteps array), 'insert' to insert a step at a position (requires planId, atIndex, step), 'delete' to remove a step (requires planId, stepIndex), 'reorder' to swap a step up or down (requires planId, stepIndex, direction), 'move' to move a step from one index to another (requires planId, fromIndex, toIndex), 'replace' to replace all steps (requires planId, replacementSteps).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "update",
                "batch_update",
                "add",
                "insert",
                "delete",
                "reorder",
                "move",
                "replace"
              ],
              "description": "The action to perform"
            },
            "planId": {
              "type": "string",
              "description": "Plan ID"
            },
            "stepIndex": {
              "type": "number",
              "description": "Step index (0-based)"
            },
            "status": {
              "type": "string",
              "enum": [
                "pending",
                "active",
                "done",
                "blocked"
              ],
              "description": "Step status"
            },
            "notes": {
              "type": "string",
              "description": "Notes"
            },
            "updates": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "step_index": {
                    "type": "number"
                  },
                  "status": {
                    "type": "string"
                  },
                  "notes": {
                    "type": "string"
                  }
                }
              },
              "description": "Batch updates array"
            },
            "newSteps": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "phase": {
                    "type": "string"
                  },
                  "task": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string"
                  }
                }
              },
              "description": "New steps to add"
            },
            "atIndex": {
              "type": "number",
              "description": "Insert position (for insert)"
            },
            "step": {
              "type": "object",
              "properties": {
                "phase": {
                  "type": "string"
                },
                "task": {
                  "type": "string"
                },
                "status": {
                  "type": "string"
                }
              },
              "description": "Step to insert"
            },
            "direction": {
              "type": "string",
              "enum": [
                "up",
                "down"
              ],
              "description": "Reorder direction"
            },
            "fromIndex": {
              "type": "number",
              "description": "Source index (for move)"
            },
            "toIndex": {
              "type": "number",
              "description": "Target index (for move)"
            },
            "replacementSteps": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "phase": {
                    "type": "string"
                  },
                  "task": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string"
                  }
                }
              },
              "description": "Replacement steps array (for replace)"
            }
          },
          "required": [
            "action",
            "planId"
          ]
        }
      },
      {
        "name": "memory_context",
        "displayName": "Project Memory Context",
        "description": "Manage context - notes, briefings, handoffs, store/get context, research, batch operations, workspace-scoped CRUD",
        "modelDescription": "Manage Project Memory context. Actions: 'add_note' to add a note (requires planId, note), 'briefing' to get mission briefing (requires planId), 'handoff' to transfer to another agent (requires planId, targetAgent, reason), 'workspace' to get workspace info. 'store' to save context data (requires planId, type, data), 'get' to retrieve context (requires planId, type). 'store_initial' to store initial user request (requires planId, userRequest). 'list' to list context files (requires planId). 'list_research' to list research notes (requires planId). 'append_research' to add a research note (requires planId, filename, content). 'batch_store' to store multiple items (requires planId, items array). 'workspace_get/workspace_set/workspace_update/workspace_delete' for workspace-scoped context (requires type).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "add_note",
                "briefing",
                "handoff",
                "workspace",
                "store",
                "get",
                "store_initial",
                "list",
                "list_research",
                "append_research",
                "batch_store",
                "workspace_get",
                "workspace_set",
                "workspace_update",
                "workspace_delete",
                "write_prompt",
                "dump_context"
              ],
              "description": "The action to perform"
            },
            "planId": {
              "type": "string",
              "description": "Plan ID"
            },
            "note": {
              "type": "string",
              "description": "Note content (for add_note)"
            },
            "noteType": {
              "type": "string",
              "enum": [
                "info",
                "warning",
                "instruction"
              ],
              "description": "Note type"
            },
            "targetAgent": {
              "type": "string",
              "enum": [
                "Coordinator",
                "Researcher",
                "Architect",
                "Executor",
                "Reviewer",
                "Tester",
                "Archivist",
                "Analyst",
                "Brainstorm",
                "Runner"
              ],
              "description": "Target agent (for handoff)"
            },
            "reason": {
              "type": "string",
              "description": "Handoff reason"
            },
            "type": {
              "type": "string",
              "description": "Context type key (for store/get/workspace_*)"
            },
            "data": {
              "type": "object",
              "description": "Context data (for store/workspace_set/workspace_update)"
            },
            "userRequest": {
              "type": "string",
              "description": "User request text (for store_initial)"
            },
            "filesMentioned": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Files referenced (for store_initial)"
            },
            "requirements": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Requirements (for store_initial)"
            },
            "constraints": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Constraints (for store_initial)"
            },
            "filename": {
              "type": "string",
              "description": "Research note filename (for append_research)"
            },
            "content": {
              "type": "string",
              "description": "Research note content (for append_research)"
            },
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "data": {
                    "type": "object"
                  }
                }
              },
              "description": "Batch items (for batch_store)"
            }
          },
          "required": [
            "action"
          ]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_terminal",
        "displayName": "Project Memory Terminal",
        "description": "Execute terminal commands with session management and authorization",
        "modelDescription": "Execute terminal commands with safety guardrails. Actions: 'run' to execute a command (requires command), 'read_output' to get buffered output (requires session_id), 'kill' to terminate a process (requires session_id), 'get_allowlist' to view auto-approved commands, 'update_allowlist' to manage allowlist patterns (requires patterns, operation).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "run",
                "read_output",
                "kill",
                "get_allowlist",
                "update_allowlist"
              ],
              "description": "The action to perform"
            },
            "command": {
              "type": "string",
              "description": "Command to execute (for run)"
            },
            "args": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Command arguments (for run)"
            },
            "cwd": {
              "type": "string",
              "description": "Working directory (for run)"
            },
            "timeout": {
              "type": "number",
              "description": "Timeout in ms (for run). Default 30000"
            },
            "workspace_id": {
              "type": "string",
              "description": "Workspace ID (for run, allowlist actions)"
            },
            "session_id": {
              "type": "string",
              "description": "Session ID (for read_output, kill)"
            },
            "patterns": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Allowlist patterns (for update_allowlist)"
            },
            "operation": {
              "type": "string",
              "enum": ["add", "remove", "set"],
              "description": "How to modify the allowlist (for update_allowlist)"
            }
          },
          "required": ["action"]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_filesystem",
        "displayName": "Project Memory Filesystem",
        "description": "Workspace-scoped filesystem operations with safety boundaries",
        "modelDescription": "Workspace-scoped filesystem operations. Actions: 'read' to read a file (requires workspace_id, path), 'write' to write/create a file (requires workspace_id, path, content), 'search' to find files by glob or regex (requires workspace_id, pattern or regex), 'list' to list directory contents (requires workspace_id), 'tree' to get a recursive directory tree (requires workspace_id).",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "read",
                "write",
                "search",
                "list",
                "tree"
              ],
              "description": "The action to perform"
            },
            "workspace_id": {
              "type": "string",
              "description": "Workspace ID â€” paths are relative to workspace root"
            },
            "path": {
              "type": "string",
              "description": "File or directory path relative to workspace root"
            },
            "content": {
              "type": "string",
              "description": "File content (for write)"
            },
            "create_dirs": {
              "type": "boolean",
              "description": "Auto-create parent directories (for write). Default true"
            },
            "pattern": {
              "type": "string",
              "description": "Glob pattern (for search)"
            },
            "regex": {
              "type": "string",
              "description": "Regex pattern (for search)"
            },
            "include": {
              "type": "string",
              "description": "File include filter, e.g. '*.ts' (for search)"
            },
            "recursive": {
              "type": "boolean",
              "description": "Recurse into subdirectories (for list)"
            },
            "max_depth": {
              "type": "number",
              "description": "Maximum tree depth (for tree). Default 3, max 10"
            }
          },
          "required": ["action", "workspace_id"]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_terminal_interactive",
        "displayName": "Project Memory Interactive Terminal",
        "description": "Canonical interactive terminal contract routed through MCP bridge",
        "modelDescription": "Canonical interactive terminal tool routed through MCP. Canonical actions: 'execute', 'read_output', 'terminate', 'list'. Legacy aliases accepted for compatibility: 'run', 'kill', 'send', 'close', 'create'.",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": ["execute", "read_output", "terminate", "list", "run", "kill", "send", "close", "create"],
              "description": "The action to perform"
            },
            "invocation": {
              "type": "object",
              "description": "Invocation mode/intent metadata"
            },
            "correlation": {
              "type": "object",
              "description": "Correlation metadata"
            },
            "runtime": {
              "type": "object",
              "description": "Runtime metadata including adapter hints"
            },
            "execution": {
              "type": "object",
              "description": "Execution payload"
            },
            "target": {
              "type": "object",
              "description": "Target identity payload"
            },
            "compat": {
              "type": "object",
              "description": "Compatibility metadata"
            },
            "workspace_id": {
              "type": "string",
              "description": "Legacy workspace_id"
            },
            "cwd": {
              "type": "string",
              "description": "Legacy cwd"
            },
            "timeout": {
              "type": "number",
              "description": "Legacy timeout"
            },
            "timeout_ms": {
              "type": "number",
              "description": "Legacy timeout_ms"
            },
            "command": {
              "type": "string",
              "description": "Legacy command"
            },
            "args": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Legacy args"
            },
            "env": {
              "type": "object",
              "description": "Legacy env"
            },
            "session_id": {
              "type": "string",
              "description": "Legacy session target"
            },
            "terminal_id": {
              "type": "string",
              "description": "Legacy terminal target"
            }
          },
          "required": ["action"]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_terminal_vscode",
        "displayName": "Project Memory VS Code Terminal",
        "description": "Create and manage visible VS Code integrated terminals with safety guardrails",
        "modelDescription": "Manage visible host terminals in VS Code. Actions: 'create', 'send', 'close', 'list'.",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": ["create", "send", "close", "list"],
              "description": "The action to perform"
            },
            "terminal_id": {
              "type": "string",
              "description": "Terminal identifier (for send, close)"
            },
            "name": {
              "type": "string",
              "description": "Terminal display name (for create)"
            },
            "cwd": {
              "type": "string",
              "description": "Working directory for the terminal (for create)"
            },
            "env": {
              "type": "object",
              "description": "Environment variables to set (for create)"
            },
            "command": {
              "type": "string",
              "description": "Command text to send (for send)"
            },
            "workspace_id": {
              "type": "string",
              "description": "Workspace ID for allowlist lookups (for send)"
            }
          },
          "required": ["action"]
        },
        "canBeInvokedManually": true
      },
      {
        "name": "memory_spawn_agent",
        "displayName": "Project Memory Spawn Agent",
        "description": "Prepare context and prompt payload for native runSubagent flow (does not execute spawn)",
        "modelDescription": "Prepare a Project Memory subagent spawn payload only. This tool does NOT execute subagent launch. It enriches the prompt with workspace/plan context, applies scope boundaries, and injects anti-spawning rules for spoke targets. Then call native runSubagent using prep_config.enriched_prompt. Supports compat_mode legacy/strict and a deprecated spawn_config alias during migration.",
        "parametersSchema": {
          "type": "object",
          "properties": {
            "agent_name": {
              "type": "string",
              "description": "Name of the target agent for prompt preparation (e.g., Executor, Reviewer, Tester)"
            },
            "prompt": {
              "type": "string",
              "description": "Task description used to build prep_config.enriched_prompt"
            },
            "workspace_id": {
              "type": "string",
              "description": "Workspace ID to inject into prepared context (optional)"
            },
            "plan_id": {
              "type": "string",
              "description": "Plan ID to inject into prepared context (optional)"
            },
            "compat_mode": {
              "type": "string",
              "enum": ["legacy", "strict"],
              "description": "Compatibility response mode. legacy returns prep_config + deprecated spawn_config alias; strict returns canonical prep_config only."
            },
            "prep_config": {
              "type": "object",
              "properties": {
                "scope_boundaries": {
                  "type": "object",
                  "properties": {
                    "files_allowed": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "List of files the agent is allowed to modify"
                    },
                    "directories_allowed": {
                      "type": "array",
                      "items": { "type": "string" },
                      "description": "List of directories where the agent can create files"
                    },
                    "scope_escalation_instruction": {
                      "type": "string",
                      "description": "Custom instruction for what to do if agent needs out-of-scope changes"
                    }
                  }
                }
              },
              "description": "Canonical context preparation config."
            },
            "spawn_config": {
              "type": "object",
              "description": "Deprecated input alias for prep_config. Use prep_config instead.",
              "properties": {
                "scope_boundaries": {
                  "type": "object",
                  "properties": {
                    "files_allowed": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "directories_allowed": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "scope_escalation_instruction": {
                      "type": "string"
                    }
                  }
                }
              }
            },
            "scope_boundaries": {
              "type": "object",
              "description": "Deprecated top-level alias. Prefer prep_config.scope_boundaries.",
              "properties": {
                "files_allowed": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "directories_allowed": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "scope_escalation_instruction": {
                  "type": "string"
                }
              }
            }
          },
          "required": ["agent_name", "prompt"]
        },
        "canBeInvokedManually": true
      }
    ],
    "commands": [
      {
        "command": "projectMemory.showDashboard",
        "title": "Show Dashboard",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openDashboardPanel",
        "title": "Open Full Dashboard (PMD Tab)",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.createPlan",
        "title": "Create New Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.viewPrograms",
        "title": "View Programs",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployAgents",
        "title": "Deploy Agents to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deploySkills",
        "title": "Deploy Skills to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.listSkills",
        "title": "List Skills",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deploySkill",
        "title": "Deploy Skill to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployInstructions",
        "title": "Deploy Instructions to Workspace",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.listInstructions",
        "title": "List Instructions",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployCopilotConfig",
        "title": "Deploy All Copilot Config (Agents, Skills, Instructions)",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.deployDefaults",
        "title": "Deploy Default Agents & Instructions",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.updateDefaults",
        "title": "Update Deployed Files from Source",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.refreshData",
        "title": "Refresh Dashboard",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.addToPlan",
        "title": "Add to Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.showPlanInChat",
        "title": "Show Plan In Chat",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.archivePlan",
        "title": "Archive Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.markStepActive",
        "title": "Mark Step Active",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.markStepDone",
        "title": "Mark Step Done",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.runBuildScript",
        "title": "Run Build Script",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.addStepToPlan",
        "title": "Add Step To Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.confirmAction",
        "title": "Confirm Action",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.cancelAction",
        "title": "Cancel Action",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.launchAgentChat",
        "title": "Launch Agent Chat",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openPlanInDashboard",
        "title": "Open Plan In Dashboard",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.createDedicatedPlan",
        "title": "Create Dedicated Plan",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openAgentFile",
        "title": "Open Agent File",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openPromptFile",
        "title": "Open Prompt File",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.showCopilotStatus",
        "title": "Show Copilot Status",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.toggleServer",
        "title": "Toggle Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.startServer",
        "title": "Start Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.stopServer",
        "title": "Stop Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.migrateWorkspace",
        "title": "Migrate Workspace to New Identity System",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.forceStopExternalServer",
        "title": "Force Stop External Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.restartServer",
        "title": "Restart Server",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.showServerLogs",
        "title": "Show Server Logs",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.showDiagnostics",
        "title": "Show Diagnostics",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.isolateServer",
        "title": "Toggle Isolated Server Mode",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.openSettings",
        "title": "Open Settings",
        "category": "Project Memory"
      },
      {
        "command": "projectMemory.chat.reconnect",
        "title": "Reconnect Chat to MCP Server",
        "category": "Project Memory"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "projectMemory",
          "title": "Project Memory",
          "icon": "resources/sidebar-icon.svg"
        }
      ]
    },
    "views": {
      "projectMemory": [
        {
          "type": "webview",
          "id": "projectMemory.dashboardView",
          "name": "Dashboard"
        }
      ]
    },
    "configuration": {
      "title": "Project Memory",
      "properties": {
        "projectMemory.dataRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the Project Memory data directory (MBS_DATA_ROOT)",
          "scope": "application"
        },
        "projectMemory.agentsRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the agent templates directory (MBS_AGENTS_ROOT)",
          "scope": "application"
        },
        "projectMemory.autoRefresh": {
          "type": "boolean",
          "default": true,
          "description": "Automatically refresh dashboard when files change"
        },
        "projectMemory.autoDeployAgents": {
          "type": "boolean",
          "default": false,
          "description": "Automatically deploy agents when template files are saved"
        },
        "projectMemory.apiPort": {
          "type": "number",
          "default": 3001,
          "description": "Port for the dashboard API server"
        },
        "projectMemory.serverPort": {
          "type": "number",
          "default": 3001,
          "description": "Port for the dashboard API server (same as apiPort)"
        },
        "projectMemory.wsPort": {
          "type": "number",
          "default": 3002,
          "description": "Port for the WebSocket server (live updates)"
        },
        "projectMemory.autoStartServer": {
          "type": "boolean",
          "default": false,
          "description": "Automatically start the dashboard server when extension activates. When false (default), the server starts on first dashboard open or explicit command."
        },
        "projectMemory.idleServerTimeoutMinutes": {
          "type": "number",
          "default": 0,
          "minimum": 0,
          "description": "Shut down the dashboard server after this many minutes of idle time (no WebSocket clients connected). Set to 0 to disable idle shutdown."
        },
        "projectMemory.skillsRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the skills directory containing skill subdirectories with SKILL.md files",
          "scope": "application"
        },
        "projectMemory.globalSkillsRoot": {
          "type": "string",
          "default": "",
          "description": "Fallback absolute path to main/shared skills source",
          "scope": "application"
        },
        "projectMemory.instructionsRoot": {
          "type": "string",
          "default": "",
          "description": "Path to the instruction files directory (MBS_INSTRUCTIONS_ROOT)",
          "scope": "application"
        },
        "projectMemory.defaultAgents": {
          "type": "array",
          "default": [
            "coordinator",
            "researcher",
            "architect",
            "executor",
            "reviewer",
            "tester",
            "archivist",
            "revisionist",
            "runner"
          ],
          "description": "List of agent names to auto-deploy to new workspaces"
        },
        "projectMemory.defaultInstructions": {
          "type": "array",
          "default": [
            "project-memory-system",
            "mvc-architecture",
            "handoff-protocol"
          ],
          "description": "List of instruction files to auto-deploy to new workspaces"
        },
        "projectMemory.defaultSkills": {
          "type": "array",
          "default": [],
          "description": "List of skill directory names to pre-select when deploying skills"
        },
        "projectMemory.autoDeployOnWorkspaceOpen": {
          "type": "boolean",
          "default": false,
          "description": "Automatically deploy default agents and instructions when opening a workspace"
        },
        "projectMemory.autoDeploySkills": {
          "type": "boolean",
          "default": false,
          "description": "Automatically deploy skills to workspace on open (even if full auto-deploy is off)"
        },
        "projectMemory.showNotifications": {
          "type": "boolean",
          "default": true,
          "description": "Show toast notifications for deployment and server events"
        },
        "projectMemory.chat.serverMode": {
          "type": "string",
          "enum": [
            "bundled",
            "podman",
            "external"
          ],
          "default": "bundled",
          "description": "How to run the MCP server for chat integration",
          "enumDescriptions": [
            "Spawn bundled server automatically",
            "Run in Podman container",
            "Connect to external server"
          ]
        },
        "projectMemory.chat.podmanImage": {
          "type": "string",
          "default": "project-memory-mcp:latest",
          "description": "Podman/Docker image name for MCP server (when serverMode is 'podman')"
        },
        "projectMemory.chat.externalServerPath": {
          "type": "string",
          "default": "",
          "description": "Path to external MCP server executable (when serverMode is 'external')"
        },
        "projectMemory.chat.autoConnect": {
          "type": "boolean",
          "default": true,
          "description": "Automatically connect to MCP server when extension activates"
        },
        "projectMemory.containerMode": {
          "type": "string",
          "enum": [
            "auto",
            "local",
            "container"
          ],
          "default": "auto",
          "description": "How to connect to backend services. 'auto' probes for a running container on expected ports before falling back to local server spawn. 'local' always spawns locally. 'container' always connects to container (fails if unavailable).",
          "enumDescriptions": [
            "Probe for container first, fall back to local",
            "Always spawn local server processes",
            "Always connect to container (requires running container)"
          ]
        },
        "projectMemory.containerMcpPort": {
          "type": "number",
          "default": 3000,
          "description": "Port where the containerized MCP server is expected (Streamable HTTP + SSE)"
        }
      }
    },
    "menus": {
      "explorer/context": [
        {
          "command": "projectMemory.createPlan",
          "group": "projectMemory",
          "when": "explorerResourceIsFolder"
        },
        {
          "command": "projectMemory.addToPlan",
          "group": "projectMemory@2",
          "when": "!explorerResourceIsFolder"
        }
      ],
      "editor/context": [
        {
          "command": "projectMemory.addToPlan",
          "group": "projectMemory",
          "when": "editorHasSelection"
        }
      ]
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run esbuild-base -- --production",
    "esbuild-base": "node esbuild.js",
    "esbuild": "npm run esbuild-base -- --sourcemap",
    "esbuild-watch": "npm run esbuild-base -- --sourcemap --watch",
    "compile": "npm run esbuild",
    "replay": "node ./tools/replay-cli-runner.js",
    "replay:list": "npm run replay -- list-scenarios",
    "replay:run": "npm run replay -- run",
    "watch": "npm run esbuild-watch",
    "pretest": "npm run esbuild",
    "test": "node ./out/test/runTest.js",
    "lint": "eslint src --ext ts",
    "package": "vsce package",
    "build-webview": "cd webview && npm run build"
  },
  "devDependencies": {
    "@types/mocha": "^10.0.10",
    "@types/node": "^20.10.0",
    "@types/vscode": "^1.109.0",
    "@typescript-eslint/eslint-plugin": "^8.55.0",
    "@typescript-eslint/parser": "^8.55.0",
    "@vscode/test-electron": "^2.5.2",
    "esbuild": "^0.27.3",
    "eslint": "^9.39.2",
    "mocha": "^11.7.5",
    "typescript": "^5.3.0"
  },
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.0.0",
    "chokidar": "^3.5.3",
    "glob": "^13.0.1"  },
  "overrides": {
    "diff": "^8.0.3"  }
}
